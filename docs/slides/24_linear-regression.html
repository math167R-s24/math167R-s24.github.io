<!DOCTYPE html>
<html lang="en"><head>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.3.353">

  <meta name="author" content="Peter Gao">
  <title>MATH167R - MATH167R: Linear regression</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #767676;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #767676;  padding-left: 4px; }
    div.sourceCode
      { color: #545454; background-color: #fefefe; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #545454; } /* Normal */
    code span.al { color: #7928a1; } /* Alert */
    code span.an { color: #696969; } /* Annotation */
    code span.at { color: #a55a00; } /* Attribute */
    code span.bn { color: #7928a1; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #d91e18; } /* ControlFlow */
    code span.ch { color: #008000; } /* Char */
    code span.cn { color: #d91e18; } /* Constant */
    code span.co { color: #696969; } /* Comment */
    code span.cv { color: #696969; font-style: italic; } /* CommentVar */
    code span.do { color: #696969; font-style: italic; } /* Documentation */
    code span.dt { color: #7928a1; } /* DataType */
    code span.dv { color: #7928a1; } /* DecVal */
    code span.er { color: #7928a1; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #a55a00; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #696969; } /* Information */
    code span.kw { color: #d91e18; } /* Keyword */
    code span.op { color: #00769e; } /* Operator */
    code span.ot { color: #d91e18; } /* Other */
    code span.pp { color: #7928a1; } /* Preprocessor */
    code span.sc { color: #00769e; } /* SpecialChar */
    code span.ss { color: #008000; } /* SpecialString */
    code span.st { color: #008000; } /* String */
    code span.va { color: #a55a00; } /* Variable */
    code span.vs { color: #008000; } /* VerbatimString */
    code span.wa { color: #696969; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto.css">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
<meta property="og:title" content="MATH167R - MATH167R: Linear regression">
<meta property="og:site-name" content="MATH167R">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">MATH167R: Linear regression</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Peter Gao 
</div>
</div>
</div>

</section>
<section id="overview-of-today" class="slide level2">
<h2>Overview of today</h2>
<ul>
<li>Covariance and correlation</li>
<li>Linear regression</li>
</ul>
</section>
<section id="relating-numerical-variables" class="slide level2">
<h2>Relating numerical variables</h2>

<img data-src="images/Screenshot 2023-10-29 at 10.20.45 AM.png" class="r-stretch"></section>
<section id="covariance-and-correlation" class="slide level2">
<h2>Covariance and correlation</h2>
<p>In statistics, correlation and covariance usually refer to a specific type of association.</p>
<ul>
<li>If <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span> are linearly associated, then they are correlated.</li>
</ul>
</section>
<section id="correlation" class="slide level2">
<h2>Correlation</h2>
<p>Correlation can also refer to the correlation coefficient.</p>
<p>The (Pearson) correlation coefficient <span class="math inline">\(R\)</span> is a statistic between <span class="math inline">\(-1\)</span> and 1 that describes the strength and direction of the linear relationship between two variables.</p>
<p><span class="math display">\[R = \frac{1}{n-1}\sum_{i=1}^n\frac{x_i-\overline{x}}{s_x}\frac{y_i-\overline{y}}{s_y}\]</span></p>
<p>The sign of <span class="math inline">\(R\)</span> indicates the direction of the relationship. The absolute value of <span class="math inline">\(R\)</span> indicates the strength.</p>
</section>
<section id="correlation-and-covariance" class="slide level2">
<h2>Correlation and covariance</h2>
<div class="cell" data-hash="24_linear-regression_cache/revealjs/unnamed-chunk-1_1a139a6310d72e25265f29807261e8dc">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">attach</span>(mtcars)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="fu">cor</span>(mpg, wt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.8676594</code></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="fu">cov</span>(mpg, wt)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -5.116685</code></pre>
</div>
</div>
</section>
<section id="pairs-plots-for-assessing-many-relationships" class="slide level2">
<h2>Pairs plots for assessing many relationships</h2>
<div class="cell" data-hash="24_linear-regression_cache/revealjs/unnamed-chunk-2_3f1e4eaaaf2fadc8f331413f4fa5f1a7">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="fu">pairs</span>(<span class="sc">~</span>mpg <span class="sc">+</span> hp <span class="sc">+</span> wt, mtcars)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="24_linear-regression_files/figure-revealjs/unnamed-chunk-2-1.png" width="960" class="r-stretch"></section>
<section id="regression-methods" class="slide level2">
<h2>Regression methods</h2>
<p>Assume we have some data:</p>
<ul>
<li><span class="math inline">\(X_1,\ldots, X_p\)</span>: <span class="math inline">\(p\)</span> <strong>independent variables/explanatory variables/covariates/predictors</strong></li>
<li><span class="math inline">\(Y\)</span>: the <strong>dependent variables/response/outcome</strong>.</li>
</ul>
<p>We want to know the relationship between our covariates and our response, we can do this with a method called <strong>regression</strong>. Regression provides us with a statistical method to conduct inference and prediction.</p>
</section>
<section id="regression-methods-1" class="slide level2">
<h2>Regression methods</h2>
<ul>
<li><strong>inference:</strong> assess the relationship between our variables, our statistical model as a whole, predictor importance
<ul>
<li>What is the relationship between sleep and GPA?</li>
<li>Is parents’ education or parents’ income more important for explaining income?</li>
</ul></li>
<li><strong>prediction:</strong> predict new/future outcomes from new/future covariates
<ul>
<li>Can we predict test scores based on hours spent studying?</li>
</ul></li>
</ul>
</section>
<section id="why-is-it-called-regression" class="slide level2">
<h2>Why is it called regression?</h2>

<img data-src="https://upload.wikimedia.org/wikipedia/commons/b/b2/Galton%27s_correlation_diagram_1875.jpg" class="r-stretch quarto-figure-center"></section>
<section id="simple-linear-regression" class="slide level2">
<h2>Simple linear regression</h2>
<p>How does the speed of a car affect its stopping distance?</p>
<div class="cell" data-layout-align="center" data-hash="24_linear-regression_cache/revealjs/cars_383e332520c414f10e79be23993768a5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="fu">plot</span>(dist <span class="sc">~</span> speed, <span class="at">data =</span> cars,</span>
<span id="cb6-2"><a href="#cb6-2"></a>     <span class="at">xlab =</span> <span class="st">"Speed (mph)"</span>,</span>
<span id="cb6-3"><a href="#cb6-3"></a>     <span class="at">ylab =</span> <span class="st">"Stopping Distance (ft)"</span>,</span>
<span id="cb6-4"><a href="#cb6-4"></a>     <span class="at">pch  =</span> <span class="dv">16</span>, <span class="at">col =</span> <span class="st">"blue"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="24_linear-regression_files/figure-revealjs/cars-1.png" style="width:60.0%" class="r-stretch quarto-figure-center"></section>
<section id="simple-linear-regression-1" class="slide level2">
<h2>Simple linear regression</h2>
<p>Suppose <span class="math inline">\(x_1,\ldots, x_n\)</span> represent the <code>speed</code> values of each car in our dataset. Let <span class="math inline">\(Y_1,\ldots, Y_n\)</span> represent the <code>dist</code> variable.</p>
<p>The <strong>simple linear regression model</strong> is given by <span class="math display">\[Y_i=\beta_0+\beta_1x_i+\epsilon_i\]</span> where:</p>
<ul>
<li><p><span class="math inline">\(\beta_0\)</span> is the intercept parameter</p></li>
<li><p><span class="math inline">\(\beta_1\)</span> is the slope parameter</p></li>
<li><p><span class="math inline">\(\epsilon_i\)</span> represents iid <span class="math inline">\(N(0,\sigma^2)\)</span> errors, where <span class="math inline">\(\sigma^2\)</span> is the variance of <span class="math inline">\(\epsilon_i\)</span>.</p></li>
</ul>
</section>
<section id="simple-linear-regression-2" class="slide level2">
<h2>Simple linear regression</h2>
<p>Under this model, we can also write that <span class="math display">\[Y_i\mid X_i= x_i\sim N(\beta_0+\beta_1x_i, \sigma^2)\]</span> As a result <span class="math display">\[E(Y_i\mid X_i= x_i)= \beta_0+\beta_1x_i\]</span> <span class="math display">\[\mathrm{Var}(Y_i\mid X_i= x_i)= \sigma^2\]</span></p>
</section>
<section id="simple-linear-regression-3" class="slide level2">
<h2>Simple linear regression</h2>
<p>Typically, we say there are four assumptions for simple linear regression:</p>
<ul>
<li><strong>Linearity</strong>: The relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(E(Y\mid X)\)</span> is linear: <span class="math display">\[E(Y_i\mid X_i= x_i)= \beta_0+\beta_1x_i\]</span></li>
<li><strong>Independence</strong>: The observations <span class="math inline">\(Y_1,\ldots, Y_n\)</span> are independent of each other.</li>
<li><strong>Normality</strong>: <span class="math display">\[Y_i\mid X_i= x_i\sim N(\beta_0+\beta_1x_i, \sigma^2)\]</span></li>
<li><strong>Equal variance</strong>: The variance of the errors <span class="math inline">\(\epsilon_i\)</span> is the same for all values of <span class="math inline">\(x_i\)</span>.</li>
</ul>
<p>Note that even if one or more of these assumptions breaks, linear regression can still be useful if used with caution.</p>
</section>
<section id="simple-linear-regression-least-squares" class="slide level2">
<h2>Simple linear regression: Least squares</h2>
<p>Typically, we start with data <span class="math inline">\(Y_1,\ldots, Y_n\)</span> and <span class="math inline">\(x_1,\ldots, x_n\)</span>. How do we estimate <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>?</p>
<p>In other words, what is the best line to use for modeling the relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>?</p>
<p>Usually, we use the least squares line, which is the solution to the following optimization problem: <span class="math display">\[\arg\min\sum_{i=1}^n (y_i-(\beta_0+\beta_1x_i))^2=\arg\min\sum_{i=1}^n (y_i-\widehat{y}_i)^2\]</span> where <span class="math inline">\(\widehat{y}_i\)</span> is the model prediction for <span class="math inline">\(y_i\)</span>.</p>
</section>
<section id="simple-linear-regression-the-lm-function" class="slide level2">
<h2>Simple linear regression: the <code>lm</code> function</h2>
<div class="cell" data-layout-align="center" data-hash="24_linear-regression_cache/revealjs/cars2_8797e070922b7733b0aa252703533a8c">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>lm_res <span class="ot">=</span> <span class="fu">lm</span>(dist <span class="sc">~</span> speed, <span class="at">data =</span> cars)</span>
<span id="cb7-2"><a href="#cb7-2"></a>lm_res</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = dist ~ speed, data = cars)

Coefficients:
(Intercept)        speed  
    -17.579        3.932  </code></pre>
</div>
</div>
</section>
<section id="simple-linear-regression-the-lm-function-1" class="slide level2">
<h2>Simple linear regression: the <code>lm</code> function</h2>
<div class="cell" data-layout-align="center" data-hash="24_linear-regression_cache/revealjs/cars3_acfc57ee61f091f9152c64a6979afb47">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="fu">plot</span>(dist <span class="sc">~</span> speed, <span class="at">data =</span> cars,</span>
<span id="cb9-2"><a href="#cb9-2"></a>     <span class="at">xlab =</span> <span class="st">"Speed (mph)"</span>,</span>
<span id="cb9-3"><a href="#cb9-3"></a>     <span class="at">ylab =</span> <span class="st">"Stopping Distance (ft)"</span>, </span>
<span id="cb9-4"><a href="#cb9-4"></a>     <span class="at">pch  =</span> <span class="dv">16</span>, <span class="at">col  =</span> <span class="st">"blue"</span>)</span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="fu">abline</span>(lm_res,  <span class="at">col =</span> <span class="st">"red"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="24_linear-regression_files/figure-revealjs/cars3-1.png" style="width:60.0%" class="r-stretch quarto-figure-center"></section>
<section id="simple-linear-regression-inference" class="slide level2">
<h2>Simple linear regression: Inference</h2>
<p>For the simple linear regression model, typically we wish to carry out inference on <span class="math inline">\(\beta_1\)</span>. One way to do so is via a hypothesis test:</p>
<p><span class="math inline">\(H_0:\beta_1=0\)</span> <span class="math inline">\(H_a:\beta_1\not=0\)</span></p>
<div class="cell" data-layout-align="center" data-hash="24_linear-regression_cache/revealjs/cars_inf_8e4c230cd91aa391f2224148d0a0b668">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="fu">summary</span>(lm_res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = dist ~ speed, data = cars)

Residuals:
    Min      1Q  Median      3Q     Max 
-29.069  -9.525  -2.272   9.215  43.201 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -17.5791     6.7584  -2.601   0.0123 *  
speed         3.9324     0.4155   9.464 1.49e-12 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 15.38 on 48 degrees of freedom
Multiple R-squared:  0.6511,    Adjusted R-squared:  0.6438 
F-statistic: 89.57 on 1 and 48 DF,  p-value: 1.49e-12</code></pre>
</div>
</div>
</section>
<section id="simple-linear-regression-inference-1" class="slide level2">
<h2>Simple linear regression: Inference</h2>
<p>We can also construct a confidence interval for <span class="math inline">\(\beta_1\)</span> if our focus isn’t on developing evidence against any null hypothesis:</p>
<div class="cell" data-layout-align="center" data-hash="24_linear-regression_cache/revealjs/cars_inf2_e633622282b5266bdf581bcf5039f6ec">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="fu">confint</span>(lm_res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 2.5 %    97.5 %
(Intercept) -31.167850 -3.990340
speed         3.096964  4.767853</code></pre>
</div>
</div>
</section>
<section id="simple-linear-regression-prediction" class="slide level2">
<h2>Simple linear regression: Prediction</h2>
<p>Prediction generally involves estimating the value of new data <span class="math inline">\(Y_{n+1}\)</span> given <span class="math inline">\(X_{n+1}\)</span>. We can use the <code>predict()</code> function with our <code>lm()</code> results:</p>
<div class="cell" data-layout-align="center" data-hash="24_linear-regression_cache/revealjs/cars_pred_c6578d1e2a7f32c3d7b0d40178cd8d40">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="fu">predict</span>(lm_res,</span>
<span id="cb14-2"><a href="#cb14-2"></a>        <span class="at">newdata =</span> <span class="fu">list</span>(<span class="at">speed =</span> <span class="fl">19.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1 
59.10288 </code></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="co"># get prediction interval</span></span>
<span id="cb16-2"><a href="#cb16-2"></a><span class="fu">predict</span>(lm_res, </span>
<span id="cb16-3"><a href="#cb16-3"></a>        <span class="at">newdata =</span> <span class="fu">list</span>(<span class="at">speed =</span> <span class="fl">19.5</span>),</span>
<span id="cb16-4"><a href="#cb16-4"></a>        <span class="at">interval =</span> <span class="st">"prediction"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       fit      lwr      upr
1 59.10288 27.68517 90.52059</code></pre>
</div>
</div>
</section>
<section id="simple-linear-regression-prediction-1" class="slide level2">
<h2>Simple linear regression: Prediction</h2>
<p>Note that the <code>predict()</code> function can also be used to generate “confidence” intervals:</p>
<ul>
<li><code>interval = "prediction"</code>: Construct a confidence interval for <span class="math inline">\(Y_{n+1}|X_{n+1}=x_{n+1}\)</span>, the value of a new <strong>observation</strong> for which <span class="math inline">\(X_{n+1}=x_{n+1}\)</span></li>
<li><code>interval = "confidence"</code>: Construct a confidence interval for <span class="math inline">\(E(Y_{n+1}|X_{n+1}=x_{n+1})\)</span>, the value of the <strong>conditional mean</strong> when <span class="math inline">\(X_{n+1}=x_{n+1}\)</span></li>
</ul>
</section>
<section id="simple-linear-regression-prediction-2" class="slide level2">
<h2>Simple linear regression: Prediction</h2>
<div class="cell" data-layout-align="center" data-hash="24_linear-regression_cache/revealjs/cars_pred2_518b3f84b754d5e0435d129d2f4cde1a">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="co"># prediction interval</span></span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="fu">predict</span>(lm_res, </span>
<span id="cb18-3"><a href="#cb18-3"></a>        <span class="at">newdata =</span> <span class="fu">list</span>(<span class="at">speed =</span> <span class="fl">19.5</span>),</span>
<span id="cb18-4"><a href="#cb18-4"></a>        <span class="at">interval =</span> <span class="st">"prediction"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       fit      lwr      upr
1 59.10288 27.68517 90.52059</code></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="co"># confidence interval</span></span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="fu">predict</span>(lm_res, </span>
<span id="cb20-3"><a href="#cb20-3"></a>        <span class="at">newdata =</span> <span class="fu">list</span>(<span class="at">speed =</span> <span class="fl">19.5</span>),</span>
<span id="cb20-4"><a href="#cb20-4"></a>        <span class="at">interval =</span> <span class="st">"confidence"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       fit      lwr     upr
1 59.10288 53.54796 64.6578</code></pre>
</div>
</div>
</section>
<section id="warm-up" class="slide level2">
<h2>Warm-up</h2>
<p>What is the method of least squares and how does it relate to linear regression?</p>
<p>Classify the following questions as <strong>inference</strong> or <strong>prediction</strong>:</p>
<ol type="1">
<li>Can we use high school students’ SAT/ACT scores to estimate their college GPAs?</li>
<li>Is there an association between political candidates’ heights and the number of votes they receive?</li>
<li>Do states with higher minimum wages have lower poverty rates?</li>
</ol>
</section>
<section id="simple-linear-regression-checking-assumptions" class="slide level2">
<h2>Simple linear regression: Checking assumptions</h2>
<p>Typically, we say there are four assumptions for simple linear regression:</p>
<ul>
<li><strong>Linearity</strong>: The relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(E(Y\mid X)\)</span> is linear: <span class="math display">\[E(Y_i\mid X_i= x_i)= \beta_0+\beta_1x_i\]</span></li>
<li><strong>Independence</strong>: The observations <span class="math inline">\(Y_1,\ldots, Y_n\)</span> are independent of each other.</li>
<li><strong>Normality</strong>: <span class="math display">\[Y_i\mid X_i= x_i\sim N(\beta_0+\beta_1x_i, \sigma^2)\]</span></li>
<li><strong>Equal variance</strong>: The variance of the errors <span class="math inline">\(\epsilon_i\)</span> is the same for all values of <span class="math inline">\(x_i\)</span>.</li>
</ul>
</section>
<section id="checking-linearity" class="slide level2">
<h2>Checking linearity</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>Linear</strong></p>
<div class="cell" data-layout-align="center" data-hash="24_linear-regression_cache/revealjs/lin_02fcf20d63fe47da2ebb27518deafaea">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="24_linear-regression_files/figure-revealjs/lin-1.png" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<p><strong>Nonlinear</strong></p>
<div class="cell" data-layout-align="center" data-hash="24_linear-regression_cache/revealjs/nonlin_e18b55fe7ba7c05d7bf49d609eee12e0">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="24_linear-regression_files/figure-revealjs/nonlin-1.png" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="checking-linearity-with-residual-plot" class="slide level2">
<h2>Checking linearity with residual plot</h2>
<p>We can also plot the residuals against our independent variable, where we define the <strong>residual</strong> as follows: <span class="math display">\[\widehat{\epsilon}_i = \mathrm{Residual} = \mathrm{Observed} - \mathrm{Predicted}=y -\widehat{y}\]</span></p>

<img data-src="24_linear-regression_files/figure-revealjs/cars_resid-1.png" style="width:60.0%" class="r-stretch quarto-figure-center"></section>
<section id="checking-linearity-with-residual-plot-1" class="slide level2">
<h2>Checking linearity with residual plot</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>Linear</strong></p>
<div class="cell" data-layout-align="center" data-hash="24_linear-regression_cache/revealjs/lin_resid_63ac0f4095c8b4b67598f3c4ac412d15">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="24_linear-regression_files/figure-revealjs/lin_resid-1.png" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<p><strong>Nonlinear</strong></p>
<div class="cell" data-layout-align="center" data-hash="24_linear-regression_cache/revealjs/nonlin_resid_cfc4363be4a8768210241fb2d94913a0">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="24_linear-regression_files/figure-revealjs/nonlin_resid-1.png" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="checking-independence" class="slide level2">
<h2>Checking independence</h2>
<p>Checking independence is typically more difficult. We require that conditional on the dependent variables <span class="math inline">\(x_1,\ldots, x_n\)</span>, the response variables <span class="math inline">\(Y_1,\ldots, Y_n\)</span> are independent.</p>
<p>Example of independence: survey data obtained via simple random sampling</p>
<p>Example of dependence: height and weight measurements of penguins, where each penguin is measured twice</p>
</section>
<section id="checking-normality-of-errors" class="slide level2">
<h2>Checking normality of errors</h2>
<p>Can you spot the difference?</p>
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>Normal errors</strong></p>
<div class="cell" data-layout-align="center" data-hash="24_linear-regression_cache/revealjs/norm_err_31b47f75f985b99a059893addffa76e2">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="24_linear-regression_files/figure-revealjs/norm_err-1.png" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<p><strong>Non-normal errors</strong></p>
<div class="cell" data-layout-align="center" data-hash="24_linear-regression_cache/revealjs/nonnorm_err_86780495c6f833966354d89290a8b568">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="24_linear-regression_files/figure-revealjs/nonnorm_err-1.png" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="checking-normality-of-errors-with-quantile-quantile-plot" class="slide level2">
<h2>Checking normality of errors with quantile-quantile plot</h2>
<p>We can use a quantile-quantile plot to see whether our estimated residuals are approximately normally distributed.</p>
<div class="cell" data-layout-align="center" data-hash="24_linear-regression_cache/revealjs/cars_resid_qq_dummy_c1f1bd60a9c370d2b113bc5e4c89c206">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>lm_res <span class="ot">&lt;-</span> <span class="fu">lm</span>(dist <span class="sc">~</span> speed, cars)</span>
<span id="cb22-2"><a href="#cb22-2"></a><span class="fu">qqnorm</span>(<span class="fu">resid</span>(lm_res))</span>
<span id="cb22-3"><a href="#cb22-3"></a><span class="fu">qqline</span>(<span class="fu">resid</span>(lm_res))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="checking-normality-of-errors-with-quantile-quantile-plot-1" class="slide level2">
<h2>Checking normality of errors with quantile-quantile plot</h2>
<p>What do you notice?</p>

<img data-src="24_linear-regression_files/figure-revealjs/cars_resid_qq-1.png" style="width:60.0%" class="r-stretch quarto-figure-center"></section>
<section id="checking-normality-of-errors-with-quantile-quantile-plot-2" class="slide level2">
<h2>Checking normality of errors with quantile-quantile plot</h2>
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>Normal errors</strong></p>
<div class="cell" data-layout-align="center" data-hash="24_linear-regression_cache/revealjs/norm_err_qq_5a398f687b356585426e64d4834538ce">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="24_linear-regression_files/figure-revealjs/norm_err_qq-1.png" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<p><strong>Non-normal errors</strong></p>
<div class="cell" data-layout-align="center" data-hash="24_linear-regression_cache/revealjs/nonnorm_err_qq_55011cea5418a5a8a6b5684e121db222">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="24_linear-regression_files/figure-revealjs/nonnorm_err_qq-1.png" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="checking-equal-variances-homoskedasticity" class="slide level2">
<h2>Checking equal variances (homoskedasticity)</h2>
<p>Can you spot the difference?</p>
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>Equal variances</strong></p>
<div class="cell" data-layout-align="center" data-hash="24_linear-regression_cache/revealjs/eq_var_3919adf2ed600b0995007000cdd334cd">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="24_linear-regression_files/figure-revealjs/eq_var-1.png" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<p><strong>Unequal variances</strong></p>
<div class="cell" data-layout-align="center" data-hash="24_linear-regression_cache/revealjs/uneq_var_665856160fd8f706f0bb388e77141e53">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="24_linear-regression_files/figure-revealjs/uneq_var-1.png" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="checking-equal-variances-homoskedasticity-with-residual-plot" class="slide level2">
<h2>Checking equal variances (homoskedasticity) with residual plot</h2>
<p>Can you spot the difference using the residual plot?</p>
<div class="columns">
<div class="column" style="width:50%;">
<p><strong>Equal variances</strong></p>
<div class="cell" data-layout-align="center" data-hash="24_linear-regression_cache/revealjs/eq_var_resid_1ce515a8de3a105312dd229a5aabd4bc">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="24_linear-regression_files/figure-revealjs/eq_var_resid-1.png" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div><div class="column" style="width:50%;">
<p><strong>Unequal variances</strong></p>
<div class="cell" data-layout-align="center" data-hash="24_linear-regression_cache/revealjs/uneq_var_resid_512609e18951307ed808520545b107ce">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="24_linear-regression_files/figure-revealjs/uneq_var_resid-1.png" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="multiple-linear-regression" class="slide level2">
<h2>Multiple linear regression</h2>
<p>What if we have multiple input variables?</p>
<div class="cell" data-hash="24_linear-regression_cache/revealjs/unnamed-chunk-3_91b000e86b54bd6b9a2e6ebed27e8db8">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a><span class="fu">data</span>(mtcars)</span>
<span id="cb23-2"><a href="#cb23-2"></a><span class="fu">head</span>(mtcars)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                   mpg cyl disp  hp drat    wt  qsec vs am gear carb
Mazda RX4         21.0   6  160 110 3.90 2.620 16.46  0  1    4    4
Mazda RX4 Wag     21.0   6  160 110 3.90 2.875 17.02  0  1    4    4
Datsun 710        22.8   4  108  93 3.85 2.320 18.61  1  1    4    1
Hornet 4 Drive    21.4   6  258 110 3.08 3.215 19.44  1  0    3    1
Hornet Sportabout 18.7   8  360 175 3.15 3.440 17.02  0  0    3    2
Valiant           18.1   6  225 105 2.76 3.460 20.22  1  0    3    1</code></pre>
</div>
</div>
</section>
<section id="multiple-linear-regression-1" class="slide level2">
<h2>Multiple linear regression</h2>
<p>Given our response <span class="math inline">\(Y\)</span> and our predictors <span class="math inline">\(X_1, \ldots, X_p\)</span>, a <strong>linear regression model</strong> takes the form:</p>
<p><span class="math display">\[
\begin{align}
Y &amp;= \beta_0 + \beta_1 X_1 + \cdots + \beta_p X_p + \epsilon,\\
\epsilon &amp;\sim N(0,\sigma^2)
\end{align}
\]</span></p>
<p><strong>Note:</strong> If we wish to include a categorical covariate, we can add indicator variables for each category.</p>
</section>
<section id="multiple-linear-regression-2" class="slide level2">
<h2>Multiple linear regression</h2>
<p><span class="math display">\[
\begin{align}
Y &amp;= \beta_0 + \beta_1 X_1 + \cdots + \beta_p X_p + \epsilon,\\
\epsilon &amp;\sim N(0,\sigma^2)
\end{align}
\]</span></p>
<ul>
<li><span class="math inline">\(Y\)</span>: dependent variable, outcome, response</li>
<li><span class="math inline">\(X_j\)</span>: independent variable, covariate, predictor</li>
<li><span class="math inline">\(\beta_0\)</span>: Intercept</li>
<li><span class="math inline">\(\beta_j\)</span>: coefficient, the expected difference in the response between two observations differing by one unit in <span class="math inline">\(X_j\)</span>, with all other covariates identical.</li>
<li><span class="math inline">\(\epsilon\)</span>: error, noise, with mean <span class="math inline">\(0\)</span> and variance <span class="math inline">\(\sigma^2\)</span></li>
</ul>
</section>
<section id="multiple-linear-regression-example" class="slide level2">
<h2>Multiple linear regression: example</h2>
<p>Consider the following example using the <code>penguins</code> data.</p>
<div class="cell" data-layout-align="center" data-hash="24_linear-regression_cache/revealjs/penguins_17d1b17a2e4ac1b42e9eb46b9269069c">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="fu">library</span>(palmerpenguins)</span>
<span id="cb25-2"><a href="#cb25-2"></a><span class="fu">data</span>(penguins)</span>
<span id="cb25-3"><a href="#cb25-3"></a><span class="fu">head</span>(penguins)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 6 × 8
  species island    bill_length_mm bill_depth_mm flipper_length_mm body_mass_g
  &lt;fct&gt;   &lt;fct&gt;              &lt;dbl&gt;         &lt;dbl&gt;             &lt;int&gt;       &lt;int&gt;
1 Adelie  Torgersen           39.1          18.7               181        3750
2 Adelie  Torgersen           39.5          17.4               186        3800
3 Adelie  Torgersen           40.3          18                 195        3250
4 Adelie  Torgersen           NA            NA                  NA          NA
5 Adelie  Torgersen           36.7          19.3               193        3450
6 Adelie  Torgersen           39.3          20.6               190        3650
# ℹ 2 more variables: sex &lt;fct&gt;, year &lt;int&gt;</code></pre>
</div>
</div>
</section>
<section id="multiple-linear-regression-example-1" class="slide level2">
<h2>Multiple linear regression: example</h2>
<p>Suppose we are interested in predicting <code>body_mass_g</code> using <code>flipper_length_mm</code>.</p>
<div class="cell" data-layout-align="center" data-hash="24_linear-regression_cache/revealjs/penguins2_0d221af4a0f6b674db15740dd8cf776c">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1"></a><span class="fu">ggplot</span>(penguins, <span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> flipper_length_mm, <span class="at">y =</span> body_mass_g)) <span class="sc">+</span></span>
<span id="cb27-2"><a href="#cb27-2"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb27-3"><a href="#cb27-3"></a>  <span class="fu">geom_smooth</span>(<span class="at">method =</span> <span class="st">"lm"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>

</div>
<img data-src="24_linear-regression_files/figure-revealjs/penguins2-1.png" style="width:60.0%" class="r-stretch quarto-figure-center"></section>
<section id="multiple-linear-regression-example-2" class="slide level2">
<h2>Multiple linear regression: example</h2>
<div class="cell" data-layout-align="center" data-hash="24_linear-regression_cache/revealjs/movies3_3e3ec5c7d3096fdf000dc2d079ae0ddc">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a>lm_res <span class="ot">&lt;-</span> <span class="fu">lm</span>(body_mass_g <span class="sc">~</span> flipper_length_mm, <span class="at">data =</span> penguins)</span>
<span id="cb28-2"><a href="#cb28-2"></a><span class="fu">summary</span>(lm_res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = body_mass_g ~ flipper_length_mm, data = penguins)

Residuals:
     Min       1Q   Median       3Q      Max 
-1058.80  -259.27   -26.88   247.33  1288.69 

Coefficients:
                   Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)       -5780.831    305.815  -18.90   &lt;2e-16 ***
flipper_length_mm    49.686      1.518   32.72   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 394.3 on 340 degrees of freedom
  (2 observations deleted due to missingness)
Multiple R-squared:  0.759, Adjusted R-squared:  0.7583 
F-statistic:  1071 on 1 and 340 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
<section id="multiple-linear-regression-example-3" class="slide level2">
<h2>Multiple linear regression: example</h2>
<p>Consider the following residual plot, where we define the <strong>residual</strong> as follows: <span class="math display">\[\mathrm{Residual} = \mathrm{Observed} - \mathrm{Predicted}=y -\widehat{y}\]</span></p>

<img data-src="24_linear-regression_files/figure-revealjs/penguins_resid-1.png" style="width:100.0%" class="r-stretch quarto-figure-center"></section>
<section id="multiple-linear-regression-example-4" class="slide level2">
<h2>Multiple linear regression: example</h2>
<p>What if I also want to include <code>species</code> in the model? There are a few ways to do so.</p>

<img data-src="24_linear-regression_files/figure-revealjs/movies4-1.png" style="width:100.0%" class="r-stretch quarto-figure-center"></section>
<section id="multiple-linear-regression-group-intercepts" class="slide level2">
<h2>Multiple linear regression: Group intercepts</h2>
<p>The first way is to add <code>species</code> into the formula for our linear regression model:</p>
<div class="cell" data-layout-align="center" data-hash="24_linear-regression_cache/revealjs/penguins_species_948b450b6c544e573c054969813d905e">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a>lm_species_res <span class="ot">&lt;-</span> <span class="fu">lm</span>(body_mass_g <span class="sc">~</span> flipper_length_mm <span class="sc">+</span> species,</span>
<span id="cb30-2"><a href="#cb30-2"></a>                     <span class="at">data =</span> penguins)</span>
<span id="cb30-3"><a href="#cb30-3"></a><span class="fu">summary</span>(lm_species_res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = body_mass_g ~ flipper_length_mm + species, data = penguins)

Residuals:
    Min      1Q  Median      3Q     Max 
-927.70 -254.82  -23.92  241.16 1191.68 

Coefficients:
                   Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)       -4031.477    584.151  -6.901 2.55e-11 ***
flipper_length_mm    40.705      3.071  13.255  &lt; 2e-16 ***
speciesChinstrap   -206.510     57.731  -3.577 0.000398 ***
speciesGentoo       266.810     95.264   2.801 0.005392 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 375.5 on 338 degrees of freedom
  (2 observations deleted due to missingness)
Multiple R-squared:  0.7826,    Adjusted R-squared:  0.7807 
F-statistic: 405.7 on 3 and 338 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
<section id="multiple-linear-regression-group-intercepts-1" class="slide level2">
<h2>Multiple linear regression: Group intercepts</h2>
<p>In this case, the model is as follows: <span class="math display">\[Y=\beta_0+\beta_1x_1+\beta_2x_2+\beta_3x_3+\epsilon_i\]</span> where:</p>
<ul>
<li><span class="math inline">\(Y\)</span> is <code>body_mass_g</code></li>
<li><span class="math inline">\(x_1\)</span> is <code>flipper_length_mm</code></li>
<li><span class="math inline">\(x_2\)</span> is a <strong>dummy variable</strong> equal to 1 if the penguin is Chinstrap and 0 otherwise.</li>
<li><span class="math inline">\(x_3\)</span> is a <strong>dummy variable</strong> equal to 1 if the penguin is Gentoo and 0 otherwise.</li>
</ul>
<p>What happened to the Adelie penguins?</p>
</section>
<section id="multiple-linear-regression-group-intercepts-2" class="slide level2">
<h2>Multiple linear regression: Group intercepts</h2>
<p>When including a categorical variable in a linear regression model, R automatically treats one category as the <strong>reference group</strong>.</p>
<p>The value of the intercept <span class="math inline">\(\beta_0\)</span> thus represents the expected value of <span class="math inline">\(Y\)</span> when <span class="math inline">\(x_1\)</span> is zero for an Adelie penguin.</p>
<p>How do we interpret the other <span class="math inline">\(\beta\)</span> parameters?</p>
</section>
<section id="multiple-linear-regression-group-intercepts-3" class="slide level2">
<h2>Multiple linear regression: Group intercepts</h2>
<ul>
<li><span class="math inline">\(\beta_1\)</span> represents the expected change in <span class="math inline">\(Y\)</span> when flipper length increases by 1 mm.</li>
<li><span class="math inline">\(\beta_2+\beta_0\)</span> represents the expected value of <span class="math inline">\(Y\)</span> when <span class="math inline">\(x_1\)</span> is zero for a Chinstrap penguin.</li>
<li><span class="math inline">\(\beta_2+\beta_0\)</span> represents the expected value of <span class="math inline">\(Y\)</span> when <span class="math inline">\(x_1\)</span> is zero for a Gentoo penguin.</li>
</ul>
</section>
<section id="multiple-linear-regression-group-intercepts-4" class="slide level2">
<h2>Multiple linear regression: Group intercepts</h2>
<p>This model thus yields three parallel lines, one for each group.</p>

<img data-src="24_linear-regression_files/figure-revealjs/penguins_species_2-1.png" style="width:60.0%" class="r-stretch quarto-figure-center"></section>
<section id="multiple-linear-regression-example-5" class="slide level2">
<h2>Multiple linear regression: example</h2>
<p>Now we obtain the following residual plot:</p>

<img data-src="24_linear-regression_files/figure-revealjs/penguins_resid_2-1.png" style="width:100.0%" class="r-stretch quarto-figure-center"></section>
<section id="multiple-linear-regression-group-specific-slopes" class="slide level2">
<h2>Multiple linear regression: Group-specific slopes</h2>
<p>The previous model gave us group-specific intercepts, resulting in parallel lines. What if we want to let the slope vary across each species?</p>

<img data-src="24_linear-regression_files/figure-revealjs/penguins_slopes-1.png" style="width:100.0%" class="r-stretch quarto-figure-center"></section>
<section id="multiple-linear-regression-group-specific-slopes-1" class="slide level2">
<h2>Multiple linear regression: Group-specific slopes</h2>
<p>The standard approach is to introduce interaction terms:</p>
<div class="cell" data-layout-align="center" data-hash="24_linear-regression_cache/revealjs/penguins_int_8581abb3998a60da0be07c548dd707d5">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a>lm_int_res <span class="ot">&lt;-</span> <span class="fu">lm</span>(body_mass_g <span class="sc">~</span> flipper_length_mm <span class="sc">*</span> species,</span>
<span id="cb32-2"><a href="#cb32-2"></a>                     <span class="at">data =</span> penguins)</span>
<span id="cb32-3"><a href="#cb32-3"></a><span class="fu">summary</span>(lm_int_res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = body_mass_g ~ flipper_length_mm * species, data = penguins)

Residuals:
    Min      1Q  Median      3Q     Max 
-911.18 -251.93  -31.77  197.82 1144.81 

Coefficients:
                                    Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                        -2535.837    879.468  -2.883  0.00419 ** 
flipper_length_mm                     32.832      4.627   7.095 7.69e-12 ***
speciesChinstrap                    -501.359   1523.459  -0.329  0.74229    
speciesGentoo                      -4251.444   1427.332  -2.979  0.00311 ** 
flipper_length_mm:speciesChinstrap     1.742      7.856   0.222  0.82467    
flipper_length_mm:speciesGentoo       21.791      6.941   3.139  0.00184 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 370.6 on 336 degrees of freedom
  (2 observations deleted due to missingness)
Multiple R-squared:  0.7896,    Adjusted R-squared:  0.7864 
F-statistic: 252.2 on 5 and 336 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
<section id="multiple-linear-regression-group-specific-slopes-2" class="slide level2">
<h2>Multiple linear regression: Group-specific slopes</h2>
<p>The standard approach is to introduce interaction terms:</p>
<p><span class="math display">\[Y=\beta_0+\beta_1x_1+\beta_2x_2+\beta_3x_3+\beta_4(x_1 * x_2) + \beta_5(x_1*x_3)+\epsilon_i\]</span> where:</p>
<ul>
<li><span class="math inline">\(\beta_1\)</span> is now the slope for our reference group (Adelie)</li>
<li><span class="math inline">\(\beta_1+\beta_4\)</span> is the slope for Chinstrap</li>
<li><span class="math inline">\(\beta_1+\beta_5\)</span> is the slope for Gentoo</li>
</ul>
</section>
<section id="linear-regression" class="slide level2">
<h2>Linear Regression</h2>
<p>We can fully write out a linear regression model</p>
<p><span class="math display">\[
\begin{equation}
\begin{bmatrix} y_1 \\ y_2\\ \vdots \\ y_n \end{bmatrix} =
\begin{bmatrix} 1 &amp; x_{1,1} &amp; \cdots &amp; x_{1,k}\\
1 &amp; x_{2,1} &amp; \cdots &amp; x_{2, k}\\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
1 &amp; x_{n,1} &amp; \cdots &amp; x_{n, k}\end{bmatrix}
\begin{bmatrix} \beta_0 \\ \beta_1 \\ \vdots \\ \beta_{k} \end{bmatrix} +
\begin{bmatrix} \epsilon_1 \\ \epsilon_2 \\ \vdots \\ \epsilon_{n} \end{bmatrix}
\end{equation}
\]</span></p>
</section>
<section id="matrix-notation" class="slide level2">
<h2>Matrix Notation</h2>
<p>This can also be expressed in matrix form:</p>
<p><span class="math display">\[
\begin{align}
\mathbf{Y} &amp;= \mathbf{X}\beta + \epsilon,\\
\epsilon &amp;\sim N(0,1)
\end{align}
\]</span></p>
<ul>
<li><span class="math inline">\(\mathbf{Y} \in \mathbb{R}^{n \times 1}\)</span>: an n-dimensional vector of the response</li>
<li><span class="math inline">\(\mathbf{X} \in \mathbb{R}^{n \times (k+1)}\)</span>: a <span class="math inline">\(((k+1)\times n)\)</span> matrix of the predictors (including intercept)</li>
<li><span class="math inline">\(\beta \in \mathbb{R}^{((k+1)\times 1)}\)</span>: a <span class="math inline">\((k+1)\)</span>-dimensional vector of regression parameters</li>
<li><span class="math inline">\(\epsilon \in \mathbb{R}^{n \times 1}\)</span>: an n-dimensional vector of the error term</li>
</ul>
</section>
<section id="large-epsilon-error-term" class="slide level2">
<h2><span class="math inline">\(\large \epsilon\)</span>: Error term</h2>
<p><span class="math inline">\(\epsilon\)</span>, pronounced epsilon, represents the <strong>error term</strong> of our model. We can model <span class="math inline">\(Y\)</span> as a linear function of the <span class="math inline">\(X\)</span>’s, but in the real world, the relationship won’t always be perfect. There is noise! It can come from</p>
<ul>
<li>Measurement error in the <span class="math inline">\(X\)</span>’s</li>
<li>Measurement error in the <span class="math inline">\(Y\)</span>’s</li>
<li>Unobserved/missing variables in the model</li>
<li>Deviations in the true model from linearity</li>
<li>True randomness</li>
</ul>
<p>In linear regression, we assume that this error term is normally distributed with mean zero and variance <span class="math inline">\(\sigma^2\)</span>.</p>
</section>
<section id="beta_0-intercept" class="slide level2">
<h2><span class="math inline">\(\beta_0\)</span>: Intercept</h2>
<p><span class="math inline">\(\beta_0\)</span> is the <strong>intercept term</strong> of our model. Notice that</p>
<p><span class="math display">\[\mathbb{E}[Y|X_1 = X_2 = \cdots = X_p = 0] = \beta_0\]</span></p>
<p>Thus, <span class="math inline">\(\beta_0\)</span> is the expected value of our response if all the covariates are equal to <span class="math inline">\(0\)</span>. This is also known as the y-intercept of our model.</p>
</section>
<section id="x_j-independent-variable" class="slide level2">
<h2><span class="math inline">\(X_j\)</span>: Independent variable</h2>
<p><span class="math inline">\(X_j\)</span> represents the <span class="math inline">\(j\)</span><sup>th</sup> independent variable in our model. Notice that <span class="math display">\[\mathbb{E}[Y|X_1,\ldots, X_p] = \beta_0 + \beta_1 X_1 + \cdots + \beta_p X_p\]</span> What happens to this expectation if we increase <span class="math inline">\(X_j\)</span> by 1 unit, holding everything else constant?</p>
<p>The conditional expectation of <span class="math inline">\(Y\)</span> increases by <span class="math inline">\(\beta_j\)</span>.</p>
</section>
<section id="beta_j-coefficient" class="slide level2">
<h2><span class="math inline">\(\beta_j\)</span>: Coefficient</h2>
<p><span class="math inline">\(\beta_j\)</span> represents the <span class="math inline">\(j\)</span><sup>th</sup> regression coefficient in our model. From the previous slide, we saw that for every 1 unit increase in <span class="math inline">\(X_j\)</span>, holding all other variables constant, the expected value of the response increases by <span class="math inline">\(\beta_j\)</span>. From this we can derive an interpretation.</p>
<p><strong>Interpretation of</strong> <span class="math inline">\(\beta_j\)</span>: the expected difference in the response between two observations differing by one unit in <span class="math inline">\(X_j\)</span>, with all other covariates identical.</p>
</section>
<section id="lm-linear-model" class="slide level2">
<h2><code>lm()</code>: Linear Model</h2>
<p>We fit a linear regression model in R using <code>lm()</code>. The first argument is a <strong>formula</strong>, which is a type of R object. Formulas typically take the following form: <code>Y ~ X_1 + X_2 + ... + X_p</code>.</p>
<p>The dependent variable, <code>Y</code> goes on the left-hand side of the tilde <code>~</code>, which marks the formula. The independent variables are added on the right-hand side. Using this formula will give us a model in the form of</p>
<p><span class="math display">\[
\begin{align}
Y &amp;= \beta_0 + \beta_1 X_1 + \cdots + \beta_p X_p + \epsilon,\\
\epsilon &amp;\sim N(0,\sigma^2)
\end{align}
\]</span></p>
</section>
<section id="lm-linear-model-1" class="slide level2">
<h2><code>lm()</code>: Linear Model</h2>
<div class="cell" data-hash="24_linear-regression_cache/revealjs/unnamed-chunk-5_be02ddecafd0e83f88e7fd43d203d653">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="fu">data</span>(mtcars)</span>
<span id="cb34-2"><a href="#cb34-2"></a>my_lm <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> hp <span class="sc">+</span> wt, <span class="at">data =</span> mtcars)</span>
<span id="cb34-3"><a href="#cb34-3"></a><span class="fu">class</span>(my_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "lm"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a>my_lm</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mpg ~ hp + wt, data = mtcars)

Coefficients:
(Intercept)           hp           wt  
   37.22727     -0.03177     -3.87783  </code></pre>
</div>
</div>
</section>
<section id="lm-linear-model-2" class="slide level2">
<h2><code>lm()</code>: Linear Model</h2>
<p>We can see from <code>names()</code> that <code>lm</code> objects contain a lot more than they print out by default.</p>
<div class="cell" data-hash="24_linear-regression_cache/revealjs/unnamed-chunk-6_0d38a1213fd226f53904ec8ae9aac7ef">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="fu">names</span>(my_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "coefficients"  "residuals"     "effects"       "rank"         
 [5] "fitted.values" "assign"        "qr"            "df.residual"  
 [9] "xlevels"       "call"          "terms"         "model"        </code></pre>
</div>
</div>
</section>
<section id="summary-model-summaries" class="slide level2">
<h2><code>summary()</code> Model summaries</h2>
<p><code>summary()</code> or <code>summary.lm()</code> gives us a summary of our <code>lm</code> object in R.</p>
<ul>
<li>The quantiles of the residuals: hopefully, they match a normal distribution.</li>
<li>Coefficients, their standard errors, and their individual significances</li>
<li>(Adjusted) R-squared value: how much of the overall variability in the response is explained by the model?</li>
<li>F-statistic: hypothesis test for the significance of the overall model</li>
</ul>
</section>
<section id="summary-model-summaries-1" class="slide level2">
<h2><code>summary()</code> Model summaries</h2>
<div class="cell" data-hash="24_linear-regression_cache/revealjs/unnamed-chunk-7_5ec8fd56d206f9b0c069a8d199d7808a">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="fu">summary</span>(my_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mpg ~ hp + wt, data = mtcars)

Residuals:
   Min     1Q Median     3Q    Max 
-3.941 -1.600 -0.182  1.050  5.854 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 37.22727    1.59879  23.285  &lt; 2e-16 ***
hp          -0.03177    0.00903  -3.519  0.00145 ** 
wt          -3.87783    0.63273  -6.129 1.12e-06 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.593 on 29 degrees of freedom
Multiple R-squared:  0.8268,    Adjusted R-squared:  0.8148 
F-statistic: 69.21 on 2 and 29 DF,  p-value: 9.109e-12</code></pre>
</div>
</div>
</section>
<section id="plot-regression-model-diagnostics" class="slide level2">
<h2><code>plot()</code>: Regression model diagnostics</h2>
<p>Calling <code>plot(my_lm)</code> will return several diagnostic plots. Remember that we want our error term to look normally distributed with mean zero. We won’t go into all the details for this class, but here are some tips:</p>
<ul>
<li><strong>Residuals vs Fitted:</strong> these are your errors (residuals) plotted over the predicted outcome (fitted). Errors should be random, so here you want to see randomly scattered points with no discernable pattern. You want the trend line to be approximately horizontal.</li>
<li><strong>Normal Q-Q plot:</strong> These are the quantiles of your errors against the quantiles of a normal distribution. In theory, your errors should be normally distributed, so you are hoping that points are mostly along the 45-degree <span class="math inline">\(y=x\)</span> line.</li>
</ul>
</section>
<section id="plot-regression-model-diagnostics-1" class="slide level2">
<h2><code>plot()</code>: Regression model diagnostics</h2>
<ul>
<li><strong>Scale-location:</strong> This looks at the magnitude of standardized residuals over the predicted outcome. Similar interpretation as residuals vs fitted. This can make it slightly easier to identify undesireable patterns.</li>
<li><strong>Residuals vs leverage:</strong> This can help identify highly influential points, such as outliers. If points are outside dotted red lines, then removing them would noticeably alter your results. <em>Never just remove outliers!</em> If it’s real data, it’s valid and removing it will bias your results. It is much more important to understand why outliers are there than to remove them.</li>
</ul>
</section>
<section id="plot-regression-model-diagnostics-2" class="slide level2">
<h2><code>plot()</code>: Regression model diagnostics</h2>
<div class="cell" data-hash="24_linear-regression_cache/revealjs/unnamed-chunk-8_31012482bdc3cbf55357b74c15eafac3">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a><span class="fu">plot</span>(my_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>

<img data-src="24_linear-regression_files/figure-revealjs/unnamed-chunk-9-1.png" width="960" class="r-stretch"></section>
<section id="plot-regression-model-diagnostics-3" class="slide level2">
<h2><code>plot()</code>: Regression model diagnostics</h2>

<img data-src="24_linear-regression_files/figure-revealjs/unnamed-chunk-10-1.png" width="960" class="r-stretch"></section>
<section id="plot-regression-model-diagnostics-4" class="slide level2">
<h2><code>plot()</code>: Regression model diagnostics</h2>

<img data-src="24_linear-regression_files/figure-revealjs/unnamed-chunk-11-1.png" width="960" class="r-stretch"></section>
<section id="plot-regression-model-diagnostics-5" class="slide level2">
<h2><code>plot()</code>: Regression model diagnostics</h2>

<img data-src="24_linear-regression_files/figure-revealjs/unnamed-chunk-12-1.png" width="960" class="r-stretch"></section>
<section id="coef-extract-coefficients" class="slide level2">
<h2><code>coef()</code>: Extract coefficients</h2>
<p>Use <code>coef()</code> to extract estimated coefficients as a vector.</p>
<div class="cell" data-hash="24_linear-regression_cache/revealjs/unnamed-chunk-13_60cf8561a1f99a618bdf5a9018b370d1">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1"></a><span class="fu">coef</span>(my_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)          hp          wt 
37.22727012 -0.03177295 -3.87783074 </code></pre>
</div>
</div>
</section>
<section id="fitted-extract-fitted-values" class="slide level2">
<h2><code>fitted()</code> Extract fitted values</h2>
<p>Use <code>fitted()</code> to extract the fitted/estimated values for the response. This can be useful to compare how our fitted values compare to the estimated values to help assess model fit.</p>
<div class="cell" data-hash="24_linear-regression_cache/revealjs/unnamed-chunk-14_98d220184bb5d57224080cf40eecef71">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb45-2"><a href="#cb45-2"></a>mod_fits <span class="ot">&lt;-</span> <span class="fu">fitted</span>(my_lm)</span>
<span id="cb45-3"><a href="#cb45-3"></a>my_df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">actual =</span> mtcars<span class="sc">$</span>mpg, <span class="at">fitted =</span> mod_fits)</span>
<span id="cb45-4"><a href="#cb45-4"></a><span class="fu">ggplot</span>(my_df, <span class="fu">aes</span>(<span class="at">x =</span> fitted, <span class="at">y =</span> actual)) <span class="sc">+</span></span>
<span id="cb45-5"><a href="#cb45-5"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb45-6"><a href="#cb45-6"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>, <span class="at">intercept =</span> <span class="dv">0</span>, <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lty =</span> <span class="dv">2</span>) <span class="sc">+</span> </span>
<span id="cb45-7"><a href="#cb45-7"></a>  <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">15</span>) <span class="sc">+</span></span>
<span id="cb45-8"><a href="#cb45-8"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Fitted values"</span>, <span class="at">y =</span> <span class="st">"Actual values"</span>, <span class="at">title =</span> <span class="st">"Actual vs. Fitted"</span>) <span class="sc">+</span></span>
<span id="cb45-9"><a href="#cb45-9"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="fitted-extract-fitted-values-1" class="slide level2">
<h2><code>fitted()</code> Extract fitted values</h2>

<img data-src="24_linear-regression_files/figure-revealjs/unnamed-chunk-15-1.png" width="960" class="r-stretch"></section>
<section id="predict-predict-new-outcomes" class="slide level2">
<h2><code>predict()</code>: Predict new outcomes</h2>
<p>Use <code>predict()</code> to predict new outcomes given new explanatory variables. For example, pretend we observe two new cars with horsepowers of <code>100</code> and <code>150</code>, respectively, and weights of <code>3000</code> and <code>3500</code>, respectively.</p>
<div class="cell" data-hash="24_linear-regression_cache/revealjs/unnamed-chunk-16_6bd642a896b25b0f917ad61d17302199">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1"></a><span class="co"># Note: wt is in 1000s of lbs</span></span>
<span id="cb46-2"><a href="#cb46-2"></a>new_obs <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">hp =</span> <span class="fu">c</span>(<span class="dv">100</span>, <span class="dv">150</span>), <span class="at">wt =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="fl">3.5</span>))</span>
<span id="cb46-3"><a href="#cb46-3"></a><span class="fu">predict</span>(my_lm, new_obs)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       1        2 
22.41648 18.88892 </code></pre>
</div>
</div>
<p>We’ll come back to prediction in future lectures.</p>
</section>
<section id="residuals-compute-residuals" class="slide level2">
<h2><code>residuals()</code>: Compute residuals</h2>
<p>Use <code>residuals()</code> to compute the residuals for fitted values.</p>
<div class="cell" data-hash="24_linear-regression_cache/revealjs/unnamed-chunk-17_84d9fe4ef01d097d83629cf37b6b5c57">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1"></a><span class="fu">residuals</span>(my_lm)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          Mazda RX4       Mazda RX4 Wag          Datsun 710      Hornet 4 Drive 
        -2.57232940         -1.58348256         -2.47581872          0.13497989 
  Hornet Sportabout             Valiant          Duster 360           Merc 240D 
         0.37273336         -2.37381631         -1.29904236          1.51293266 
           Merc 230            Merc 280           Merc 280C          Merc 450SE 
         0.80632669         -0.77945988         -2.17945988          0.67463146 
         Merc 450SL         Merc 450SLC  Cadillac Fleetwood Lincoln Continental 
         0.25616901         -1.64993945          0.04479541          1.03726743 
  Chrysler Imperial            Fiat 128         Honda Civic      Toyota Corolla 
         5.50751301          5.80097202          1.08761978          5.85379085 
      Toyota Corona    Dodge Challenger         AMC Javelin          Camaro Z28 
        -3.08644148         -3.31136386         -3.94097947         -1.25202805 
   Pontiac Firebird           Fiat X1-9       Porsche 914-2        Lotus Europa 
         2.44325481         -0.32665313         -0.03737415          2.63023081 
     Ford Pantera L        Ferrari Dino       Maserati Bora          Volvo 142E 
        -0.74648866         -1.22541324          2.26052287         -1.58364943 </code></pre>
</div>
</div>
</section>
<section id="manipulating-formulas" class="slide level2">
<h2>Manipulating formulas</h2>
<p>Working with formulas in R can be somewhat confusing, so it is important to understand how formulas work to make sure you are fitting the intended model.</p>
</section>
<section id="section" class="slide level2">
<h2><code>- 1</code></h2>
<p>Use <code>- 1</code> to remove an intercept from your model. Only do this if you are very sure that what you are doing is appropriate. I don’t recommend doing this in practice.</p>
<div class="cell" data-hash="24_linear-regression_cache/revealjs/unnamed-chunk-18_90f922470d97b24a0babf20de3c7ede9">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1"></a>no_intercept <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> hp <span class="sc">+</span> wt <span class="sc">-</span> <span class="dv">1</span>, <span class="at">data =</span> mtcars)</span>
<span id="cb50-2"><a href="#cb50-2"></a><span class="fu">summary</span>(no_intercept)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mpg ~ hp + wt - 1, data = mtcars)

Residuals:
    Min      1Q  Median      3Q     Max 
-19.407  -2.382   2.511   7.091  23.885 

Coefficients:
   Estimate Std. Error t value Pr(&gt;|t|)   
hp -0.03394    0.03940  -0.861   0.3959   
wt  6.84045    1.89425   3.611   0.0011 **
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 11.32 on 30 degrees of freedom
Multiple R-squared:  0.7264,    Adjusted R-squared:  0.7082 
F-statistic: 39.83 on 2 and 30 DF,  p-value: 3.599e-09</code></pre>
</div>
</div>
</section>
<section id="operator" class="slide level2">
<h2><code>:</code> operator</h2>
<p>Use <code>X1:X2</code> to include an interaction effect in your model. This is useful if you have reason to believe two covariates interact, such as gender and education in a wage model. In our case, we’ll assume horsepower and weight interact in their effect on mpg.</p>
<p>Typically (always?), if you include an interaction effect, you should also include the marginal effects. You can do this automatically using <code>X1*X2</code>.</p>
</section>
<section id="operator-1" class="slide level2">
<h2><code>:</code> operator</h2>
<div class="cell" data-hash="24_linear-regression_cache/revealjs/unnamed-chunk-19_1d44fb9ff30124541041a64fd0f25eb9">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1"></a>interact <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> hp<span class="sc">:</span>wt, <span class="at">data =</span> mtcars)</span>
<span id="cb52-2"><a href="#cb52-2"></a><span class="fu">summary</span>(interact)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mpg ~ hp:wt, data = mtcars)

Residuals:
    Min      1Q  Median      3Q     Max 
-4.8831 -2.0952 -0.4577  1.2262  7.9282 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 27.745642   1.062236   26.12  &lt; 2e-16 ***
hp:wt       -0.014872   0.001727   -8.61 1.32e-09 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 3.288 on 30 degrees of freedom
Multiple R-squared:  0.7119,    Adjusted R-squared:  0.7023 
F-statistic: 74.14 on 1 and 30 DF,  p-value: 1.321e-09</code></pre>
</div>
</div>
</section>
<section id="operator-2" class="slide level2">
<h2><code>*</code> operator</h2>
<div class="cell" data-hash="24_linear-regression_cache/revealjs/unnamed-chunk-20_05dafa583c5457e21a5d2f680f25a9c5">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a>interact <span class="ot">&lt;-</span> <span class="fu">lm</span>(mpg <span class="sc">~</span> hp<span class="sc">*</span>wt, <span class="at">data =</span> mtcars)</span>
<span id="cb54-2"><a href="#cb54-2"></a><span class="fu">summary</span>(interact)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mpg ~ hp * wt, data = mtcars)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.0632 -1.6491 -0.7362  1.4211  4.5513 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 49.80842    3.60516  13.816 5.01e-14 ***
hp          -0.12010    0.02470  -4.863 4.04e-05 ***
wt          -8.21662    1.26971  -6.471 5.20e-07 ***
hp:wt        0.02785    0.00742   3.753 0.000811 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.153 on 28 degrees of freedom
Multiple R-squared:  0.8848,    Adjusted R-squared:  0.8724 
F-statistic: 71.66 on 3 and 28 DF,  p-value: 2.981e-13</code></pre>
</div>
</div>
</section>
<section id="operator-3" class="slide level2">
<h2><code>.</code> operator</h2>
<p>Use <code>~ .</code> to include all non-response variables in the input data as independent variables.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = mpg ~ ., data = mtcars)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.4506 -1.6044 -0.1196  1.2193  4.6271 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept) 12.30337   18.71788   0.657   0.5181  
cyl         -0.11144    1.04502  -0.107   0.9161  
disp         0.01334    0.01786   0.747   0.4635  
hp          -0.02148    0.02177  -0.987   0.3350  
drat         0.78711    1.63537   0.481   0.6353  
wt          -3.71530    1.89441  -1.961   0.0633 .
qsec         0.82104    0.73084   1.123   0.2739  
vs           0.31776    2.10451   0.151   0.8814  
am           2.52023    2.05665   1.225   0.2340  
gear         0.65541    1.49326   0.439   0.6652  
carb        -0.19942    0.82875  -0.241   0.8122  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.65 on 21 degrees of freedom
Multiple R-squared:  0.869, Adjusted R-squared:  0.8066 
F-statistic: 13.93 on 10 and 21 DF,  p-value: 3.793e-07</code></pre>
</div>
</div>
</section>
<section id="estimation" class="slide level2">
<h2>Estimation</h2>
<p>How do we choose/estimate <span class="math inline">\(\beta_{(k+1)\times1}\)</span>?</p>
<p>Least squares finds the line that minimizes the squared distance between the points and the line, i.e.&nbsp;makes <span class="math display">\[\left[y_i - (\beta_0 + \beta_1 x_{i, 1} + \dots + \beta_k x_{i,k})\right]^2\]</span> as small as possible for all <span class="math inline">\(i = 1, \dots, n\)</span>.</p>
<p>The vector <span class="math inline">\(\widehat{\beta}\)</span> that minimizes the sum of the squared distances is ()</p>
<p><span class="math display">\[ \widehat{\beta}=\left(\mathbf{X}^T \mathbf{X} \right)^{-1}\mathbf{X}^T \mathbf{Y}.\]</span></p>
<p>Note: In statistics, once we have estimated a parameter we put a “hat” on it, e.g.&nbsp;<span class="math inline">\(\widehat{\beta_0}\)</span> is the estimate of the true parameter <span class="math inline">\(\beta_0\)</span>.</p>
</section>
<section id="overview-of-today-1" class="slide level2">
<h2>Overview of today</h2>
<ul>
<li>Review of linear regression</li>
<li>Why use a linear model?</li>
<li>Pitfalls of linear regression: breaking assumptions and more</li>
</ul>
</section>
<section id="why-linear-regression" class="slide level2">
<h2>Why linear regression?</h2>
<p>Regression methods focus on modeling the relationship between response <span class="math inline">\(Y\)</span> and explanatory variables <span class="math inline">\(X_1,\ldots, X_p\)</span>.</p>
<p>Linear regression proposes a model of the form <span class="math display">\[Y=\beta_0+\beta_1X_1+\cdots +\beta_p X_p+\epsilon; \hspace{1em} \epsilon\sim N(0, \sigma^2)\]</span> Sometimes, the following weaker form is used (why is this weaker?) <span class="math display">\[E(Y\mid X_1,\ldots, X_p)=\beta_0+\beta_1X_1+\cdots +\beta_p X_p\]</span> In other words, the expected value of <span class="math inline">\(Y\)</span> (given <span class="math inline">\(X_1,\ldots, X_p\)</span>) is a linear transformation of <span class="math inline">\(X_1,\ldots, X_p\)</span>.</p>
</section>
<section id="why-linear-regression-1" class="slide level2">
<h2>Why linear regression?</h2>
<ol type="1">
<li><strong>Simplicity</strong>: Easy to fit, usually gets the general trend correct, hard to <strong>overfit</strong></li>
<li><strong>Interpretability</strong>: Consider the following log-normal model: <span class="math display">\[Y=\exp(\beta_0+\beta_1X_1+\cdots +\beta_p X_p+\epsilon); \hspace{1em} \epsilon\sim N(0, \sigma^2)\]</span> How do we interpret <span class="math inline">\(\beta_1\)</span>?</li>
</ol>
</section>
<section id="additivity" class="slide level2">
<h2>Additivity</h2>
<p>Note that linear regression can often be generalized to encompass other models. Consider the following model: <span class="math display">\[Y=\beta_0+\beta_1X_1 +\beta_2X_1^2\]</span> This is an example of polynomial regression, but the methods for fitting this model are essentially the same as ordinary least squares, using <span class="math inline">\(X_1^2\)</span> as an extra covariate.</p>
<p>Many alternative models can be written in this form by transforming the covariates or transforming the response <span class="math inline">\(Y\)</span>.</p>
</section>
<section id="assumptions-of-linear-regression" class="slide level2">
<h2>Assumptions of linear regression</h2>
<ul>
<li><strong>Linearity</strong>: The relationship between <span class="math inline">\(X\)</span> and <span class="math inline">\(E(Y\mid X)\)</span> is linear: <span class="math display">\[E(Y_i\mid X_i= x_i)= \beta_0+\beta_1x_i\]</span></li>
<li><strong>Independence</strong>: The observations <span class="math inline">\(Y_1,\ldots, Y_n\)</span> are independent of each other.</li>
<li><strong>Normality</strong>: <span class="math display">\[Y_i\mid X_i= x_i\sim N(\beta_0+\beta_1x_i, \sigma^2)\]</span></li>
<li><strong>Equal variance</strong>: The variance of the errors <span class="math inline">\(\epsilon_i\)</span> is the same for all values of <span class="math inline">\(x_i\)</span>.</li>
</ul>
</section>
<section id="all-assumptions-true" class="slide level2">
<h2>All assumptions true</h2>
<div class="columns">
<div class="column" style="width:60%;">
<div class="smaller">
<div class="cell" data-layout-align="center" data-hash="24_linear-regression_cache/revealjs/lm_ex_dummy_18f78fc8bf522226b77d0812db476371">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb57-2"><a href="#cb57-2"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="at">n =</span> <span class="dv">40</span>, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">5</span>)</span>
<span id="cb57-3"><a href="#cb57-3"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">40</span>, <span class="at">mean =</span> <span class="dv">1</span> <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> x)</span>
<span id="cb57-4"><a href="#cb57-4"></a>lm_res <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb57-5"><a href="#cb57-5"></a><span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb57-6"><a href="#cb57-6"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb57-7"><a href="#cb57-7"></a>  <span class="fu">geom_abline</span>(</span>
<span id="cb57-8"><a href="#cb57-8"></a>    <span class="at">slope =</span> lm_res<span class="sc">$</span>coefficients[<span class="dv">2</span>], </span>
<span id="cb57-9"><a href="#cb57-9"></a>    <span class="at">intercept =</span> lm_res<span class="sc">$</span>coefficients[<span class="dv">1</span>],</span>
<span id="cb57-10"><a href="#cb57-10"></a>    <span class="at">color =</span> <span class="st">"red"</span></span>
<span id="cb57-11"><a href="#cb57-11"></a>  ) <span class="sc">+</span> </span>
<span id="cb57-12"><a href="#cb57-12"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div><div class="column" style="width:40%;">
<div class="cell" data-layout-align="center" data-hash="24_linear-regression_cache/revealjs/lm_ex_02bf0a0ede1a333779efa910c05b1c26">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="24_linear-regression_files/figure-revealjs/lm_ex-1.png" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="all-assumptions-true-1" class="slide level2">
<h2>All assumptions true</h2>
<div class="columns">
<div class="column" style="width:45%;">
<div class="smaller">
<p><strong>Inference</strong>: Asymptotically valid confidence intervals and hypothesis tests for <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span>.</p>
</div>
</div><div class="column" style="width:55%;">
<div class="cell" data-layout-align="center" data-hash="24_linear-regression_cache/revealjs/lm_res_inf_d4a0d1925c8bddc5c7e57b78c1c6998b">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1"></a><span class="fu">summary</span>(lm_res)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.5577 -0.6187 -0.0789  0.6198  3.1659 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   0.8980     0.3527   2.546   0.0151 *  
x             2.0373     0.1170  17.420   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 1.066 on 38 degrees of freedom
Multiple R-squared:  0.8887,    Adjusted R-squared:  0.8858 
F-statistic: 303.4 on 1 and 38 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="all-assumptions-true-2" class="slide level2">
<h2>All assumptions true</h2>
<div class="columns">
<div class="column" style="width:45%;">
<div class="smaller">
<p><strong>Prediction</strong>: Assuming the model holds for new data, unbiased point predictions and asymptotically valid prediction intervals for <span class="math inline">\(Y_{n+1}\)</span>.</p>
</div>
</div><div class="column" style="width:55%;">
<div class="cell" data-layout-align="center" data-hash="24_linear-regression_cache/revealjs/lm_res_pred_18ae5a1080e28fa669c12535ec0285b8">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a><span class="fu">predict</span>(lm_res, </span>
<span id="cb60-2"><a href="#cb60-2"></a>        <span class="at">newdata =</span> <span class="fu">list</span>(<span class="at">x =</span> <span class="dv">1</span>), </span>
<span id="cb60-3"><a href="#cb60-3"></a>        <span class="at">interval =</span> <span class="st">"prediction"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       fit       lwr      upr
1 2.935285 0.7165113 5.154058</code></pre>
</div>
</div>
</div>
</div>
</section>
<section id="breaking-linearity" class="slide level2">
<h2>Breaking linearity</h2>
<p>What if <span class="math inline">\(E(Y_i\mid X_i= x_i)\not= \beta_0+\beta_1x_i\)</span>?</p>
<div class="columns">
<div class="column" style="width:60%;">
<div class="smaller">
<div class="cell" data-layout-align="center" data-hash="24_linear-regression_cache/revealjs/cubic_ex_dummy_95a6a757551b3910a4ea2737089e9e28">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1"></a>x <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="at">n =</span> <span class="dv">40</span>, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">5</span>)</span>
<span id="cb62-2"><a href="#cb62-2"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">40</span>, <span class="at">mean =</span> <span class="dv">1</span> <span class="sc">+</span> <span class="dv">2</span> <span class="sc">*</span> x<span class="sc">^</span><span class="dv">3</span>)</span>
<span id="cb62-3"><a href="#cb62-3"></a>lm_res <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x)</span>
<span id="cb62-4"><a href="#cb62-4"></a><span class="fu">ggplot</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span></span>
<span id="cb62-5"><a href="#cb62-5"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span></span>
<span id="cb62-6"><a href="#cb62-6"></a>  <span class="fu">geom_abline</span>(</span>
<span id="cb62-7"><a href="#cb62-7"></a>    <span class="at">slope =</span> lm_res<span class="sc">$</span>coefficients[<span class="dv">2</span>], </span>
<span id="cb62-8"><a href="#cb62-8"></a>    <span class="at">intercept =</span> lm_res<span class="sc">$</span>coefficients[<span class="dv">1</span>],</span>
<span id="cb62-9"><a href="#cb62-9"></a>    <span class="at">color =</span> <span class="st">"red"</span></span>
<span id="cb62-10"><a href="#cb62-10"></a>  ) <span class="sc">+</span> </span>
<span id="cb62-11"><a href="#cb62-11"></a>  <span class="fu">theme_minimal</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div><div class="column" style="width:40%;">
<div class="cell" data-layout-align="center" data-hash="24_linear-regression_cache/revealjs/cubic_ex_bb96884f32513b45a065254cc9680417">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="24_linear-regression_files/figure-revealjs/cubic_ex-1.png" style="width:100.0%"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="breaking-linearity-1" class="slide level2">
<h2>Breaking linearity</h2>
<p>Our standard inference and prediction strategies no longer work in general.</p>
<p><strong>Inference</strong>: Confidence intervals and hypothesis tests for <span class="math inline">\(\beta_0\)</span> and <span class="math inline">\(\beta_1\)</span> are no longer valid.</p>
<p><strong>Prediction</strong>: Point predictions are no longer unbiased and prediction intervals are no longer valid.</p>
</section>
<section id="collinearity" class="slide level2">
<h2>Collinearity</h2>
<p>What if our predictor variables are closely related? Consider the following simulation:</p>
<div class="cell" data-hash="24_linear-regression_cache/revealjs/unnamed-chunk-22_b5cde243af13aa6feb9fbf85508067d7">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb63-2"><a href="#cb63-2"></a>x1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb63-3"><a href="#cb63-3"></a>x2 <span class="ot">&lt;-</span> x1 <span class="sc">*</span> <span class="dv">2</span></span>
<span id="cb63-4"><a href="#cb63-4"></a>e <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb63-5"><a href="#cb63-5"></a>y <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">+</span> <span class="dv">3</span> <span class="sc">*</span> x1 <span class="sc">+</span> e</span>
<span id="cb63-6"><a href="#cb63-6"></a><span class="fu">lm</span>(y <span class="sc">~</span> x1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x1)

Coefficients:
(Intercept)           x1  
     0.8597       2.7042  </code></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a><span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x1 + x2)

Coefficients:
(Intercept)           x1           x2  
     0.8597       2.7042           NA  </code></pre>
</div>
</div>
</section>
<section id="collinearity-1" class="slide level2">
<h2>Collinearity</h2>
<p>What if our predictor variables are closely related? Consider the following simulation:</p>
<div class="cell" data-hash="24_linear-regression_cache/revealjs/unnamed-chunk-23_5d6e882cd8fd0b6eca36557b7af55690">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a>x2b <span class="ot">&lt;-</span> x1 <span class="sc">*</span> <span class="dv">2</span> <span class="sc">+</span> <span class="fu">rnorm</span>(n, <span class="at">sd =</span> .<span class="dv">01</span>)</span>
<span id="cb67-2"><a href="#cb67-2"></a><span class="fu">lm</span>(y <span class="sc">~</span> x1 <span class="sc">+</span> x2b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ x1 + x2b)

Coefficients:
(Intercept)           x1          x2b  
     0.8372     -35.8202      19.2636  </code></pre>
</div>
</div>

<div class="footer footer-default">

</div>
</section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>