<!DOCTYPE html>
<html lang="en"><head>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-html/tabby.min.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-html.min.css" rel="stylesheet" data-mode="light">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.3.353">

  <meta name="author" content="Peter Gao">
  <title>MATH167R - MATH167R: Prediction</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #767676;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #767676;  padding-left: 4px; }
    div.sourceCode
      { color: #545454; background-color: #fefefe; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #545454; } /* Normal */
    code span.al { color: #7928a1; } /* Alert */
    code span.an { color: #696969; } /* Annotation */
    code span.at { color: #a55a00; } /* Attribute */
    code span.bn { color: #7928a1; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #d91e18; } /* ControlFlow */
    code span.ch { color: #008000; } /* Char */
    code span.cn { color: #d91e18; } /* Constant */
    code span.co { color: #696969; } /* Comment */
    code span.cv { color: #696969; font-style: italic; } /* CommentVar */
    code span.do { color: #696969; font-style: italic; } /* Documentation */
    code span.dt { color: #7928a1; } /* DataType */
    code span.dv { color: #7928a1; } /* DecVal */
    code span.er { color: #7928a1; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #a55a00; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { } /* Import */
    code span.in { color: #696969; } /* Information */
    code span.kw { color: #d91e18; } /* Keyword */
    code span.op { color: #00769e; } /* Operator */
    code span.ot { color: #d91e18; } /* Other */
    code span.pp { color: #7928a1; } /* Preprocessor */
    code span.sc { color: #00769e; } /* SpecialChar */
    code span.ss { color: #008000; } /* SpecialString */
    code span.st { color: #008000; } /* String */
    code span.va { color: #a55a00; } /* Variable */
    code span.vs { color: #008000; } /* VerbatimString */
    code span.wa { color: #696969; font-style: italic; } /* Warning */
  </style>
  <link rel="stylesheet" href="../site_libs/revealjs/dist/theme/quarto.css">
  <link href="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">

  .callout {
    margin-top: 1em;
    margin-bottom: 1em;  
    border-radius: .25rem;
  }

  .callout.callout-style-simple { 
    padding: 0em 0.5em;
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
    display: flex;
  }

  .callout.callout-style-default {
    border-left: solid #acacac .3rem;
    border-right: solid 1px silver;
    border-top: solid 1px silver;
    border-bottom: solid 1px silver;
  }

  .callout .callout-body-container {
    flex-grow: 1;
  }

  .callout.callout-style-simple .callout-body {
    font-size: 1rem;
    font-weight: 400;
  }

  .callout.callout-style-default .callout-body {
    font-size: 0.9rem;
    font-weight: 400;
  }

  .callout.callout-titled.callout-style-simple .callout-body {
    margin-top: 0.2em;
  }

  .callout:not(.callout-titled) .callout-body {
      display: flex;
  }

  .callout:not(.no-icon).callout-titled.callout-style-simple .callout-content {
    padding-left: 1.6em;
  }

  .callout.callout-titled .callout-header {
    padding-top: 0.2em;
    margin-bottom: -0.2em;
  }

  .callout.callout-titled .callout-title  p {
    margin-top: 0.5em;
    margin-bottom: 0.5em;
  }
    
  .callout.callout-titled.callout-style-simple .callout-content  p {
    margin-top: 0;
  }

  .callout.callout-titled.callout-style-default .callout-content  p {
    margin-top: 0.7em;
  }

  .callout.callout-style-simple div.callout-title {
    border-bottom: none;
    font-size: .9rem;
    font-weight: 600;
    opacity: 75%;
  }

  .callout.callout-style-default  div.callout-title {
    border-bottom: none;
    font-weight: 600;
    opacity: 85%;
    font-size: 0.9rem;
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-default div.callout-content {
    padding-left: 0.5em;
    padding-right: 0.5em;
  }

  .callout.callout-style-simple .callout-icon::before {
    height: 1rem;
    width: 1rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 1rem 1rem;
  }

  .callout.callout-style-default .callout-icon::before {
    height: 0.9rem;
    width: 0.9rem;
    display: inline-block;
    content: "";
    background-repeat: no-repeat;
    background-size: 0.9rem 0.9rem;
  }

  .callout-title {
    display: flex
  }
    
  .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  .callout.no-icon::before {
    display: none !important;
  }

  .callout.callout-titled .callout-body > .callout-content > :last-child {
    margin-bottom: 0.5rem;
  }

  .callout.callout-titled .callout-icon::before {
    margin-top: .5rem;
    padding-right: .5rem;
  }

  .callout:not(.callout-titled) .callout-icon::before {
    margin-top: 1rem;
    padding-right: .5rem;
  }

  /* Callout Types */

  div.callout-note {
    border-left-color: #4582ec !important;
  }

  div.callout-note .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEU0lEQVRYCcVXTWhcVRQ+586kSUMMxkyaElstCto2SIhitS5Ek8xUKV2poatCcVHtUlFQk8mbaaziwpWgglJwVaquitBOfhQXFlqlzSJpFSpIYyXNjBNiTCck7x2/8/LeNDOZxDuEkgOXe++553zfefee+/OYLOXFk3+1LLrRdiO81yNqZ6K9cG0P3MeFaMIQjXssE8Z1JzLO9ls20MBZX7oG8w9GxB0goaPrW5aNMp1yOZIa7Wv6o2ykpLtmAPs/vrG14Z+6d4jpbSKuhdcSyq9wGMPXjonwmESXrriLzFGOdDBLB8Y6MNYBu0dRokSygMA/mrun8MGFN3behm6VVAwg4WR3i6FvYK1T7MHo9BK7ydH+1uurECoouk5MPRyVSBrBHMYwVobG2aOXM07sWrn5qgB60rc6mcwIDJtQrnrEr44kmy+UO9r0u9O5/YbkS9juQckLed3DyW2XV/qWBBB3ptvI8EUY3I9p/67OW+g967TNr3Sotn3IuVlfMLVnsBwH4fsnebJvyGm5GeIUA3jljERmrv49SizPYuq+z7c2H/jlGC+Ghhupn/hcapqmcudB9jwJ/3jvnvu6vu5lVzF1fXyZuZZ7U8nRmVzytvT+H3kilYvH09mLWrQdwFSsFEsxFVs5fK7A0g8gMZjbif4ACpKbjv7gNGaD8bUrlk8x+KRflttr22JEMRUbTUwwDQScyzPgedQHZT0xnx7ujw2jfVfExwYHwOsDTjLdJ2ebmeQIlJ7neo41s/DrsL3kl+W2lWvAga0tR3zueGr6GL78M3ifH0rGXrBC2aAR8uYcIA5gwV8zIE8onoh8u0Fca/ciF7j1uOzEnqcIm59sEXoGc0+z6+H45V1CvAvHcD7THztu669cnp+L0okAeIc6zjbM/24LgGM1gZk7jnRu1aQWoU9sfUOuhrmtaPIO3YY1KLLWZaEO5TKUbMY5zx8W9UJ6elpLwKXbsaZ4EFl7B4bMtDv0iRipKoDQT2sNQI9b1utXFdYisi+wzZ/ri/1m7QfDgEuvgUUEIJPq3DhX/5DWNqIXDOweC2wvIR90Oq3lDpdMIgD2r0dXvGdsEW5H6x6HLRJYU7C69VefO1x8Gde1ZFSJLfWS1jbCnhtOPxmpfv2LXOA2Xk2tvnwKKPFuZ/oRmwBwqRQDcKNeVQkYcOjtWVBuM/JuYw5b6isojIkYxyYAFn5K7ZBF10fea52y8QltAg6jnMqNHFBmGkQ1j+U43HMi2xMar1Nv0zGsf1s8nUsmUtPOOrbFIR8bHFDMB5zL13Gmr/kGlCkUzedTzzmzsaJXhYawnA3UmARpiYj5ooJZiUoxFRtK3X6pgNPv+IZVPcnwbOl6f+aBaO1CNvPW9n9LmCp01nuSaTRF2YxHqZ8DYQT6WsXT+RD6eUztwYLZ8rM+rcPxamv1VQzFUkzFXvkiVrySGQgJNvXHJAxiU3/NwiC03rSf05VBaPtu/Z7/B8Yn/w7eguloAAAAAElFTkSuQmCC');
  }

  div.callout-note.callout-style-default .callout-title {
    background-color: #dae6fb
  }

  div.callout-important {
    border-left-color: #d9534f !important;
  }

  div.callout-important .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAEKklEQVRYCcVXTWhcVRS+575MJym48A+hSRFr00ySRQhURRfd2HYjk2SSTokuBCkU2o0LoSKKraKIBTcuFCoidGFD08nkBzdREbpQ1EDNIv8qSGMFUboImMSZd4/f9zJv8ibJMC8xJQfO3HPPPef7zrvvvnvviIkpC9nsw0UttFunbUhpFzFtarSd6WJkStVMw5xyVqYTvkwfzuf/5FgtkVoB0729j1rjXwThS7Vio+Mo6DNnvLfahoZ+i/o32lULuJ3NNiz7q6+pyAUkJaFF6JwaM2lUJlV0MlnQn5aTRbEu0SEqHUa0A4AdiGuB1kFXRfVyg5d87+Dg4DL6m2TLAub60ilj7A1Ec4odSAc8X95sHh7+ZRPCFo6Fnp7HfU/fBng/hi10CjCnWnJjsxvDNxWw0NfV6Rv5GgP3I3jGWXumdTD/3cbEOP2ZbOZp69yniG3FQ9z1jD7bnBu9Fc2tKGC2q+uAJOQHBDRiZX1x36o7fWBs7J9ownbtO+n0/qWkvW7UPIfc37WgT6ZGR++EOJyeQDSb9UB+DZ1G6DdLDzyS+b/kBCYGsYgJbSQHuThGKRcw5xdeQf8YdNHsc6ePXrlSYMBuSIAFTGAtQo+VuALo4BX83N190NWZWbynBjhOHsmNfFWLeL6v+ynsA58zDvvAC8j5PkbOcXCMg2PZFk3q8MjI7WAG/Dp9AwP7jdGBOOQkAvlFUB+irtm16I1Zw9YBcpGTGXYmk3kQIC/Cds55l+iMI3jqhjAuaoe+am2Jw5GT3Nbz3CkE12NavmzN5+erJW7046n/CH1RO/RVa8lBLozXk9uqykkGAyRXLWlLv5jyp4RFsG5vGVzpDLnIjTWgnRy2Rr+tDKvRc7Y8AyZq10jj8DqXdnIRNtFZb+t/ZRtXcDiVnzpqx8mPcDWxgARUqx0W1QB9MeUZiNrV4qP+Ehc+BpNgATsTX8ozYKL2NtFYAHc84fG7ndxUPr+AR/iQSns7uSUufAymwDOb2+NjK27lEFocm/EE2WpyIy/Hi66MWuMKJn8RvxIcj87IM5Vh9663ziW36kR0HNenXuxmfaD8JC7tfKbrhFr7LiZCrMjrzTeGx+PmkosrkNzW94ObzwocJ7A1HokLolY+AvkTiD/q1H0cN48c5EL8Crkttsa/AXQVDmutfyku0E7jShx49XqV3MFK8IryDhYVbj7Sj2P2eBxwcXoe8T8idsKKPRcnZw1b+slFTubwUwhktrfnAt7J++jwQtLZcm3sr9LQrjRzz6cfMv9aLvgmnAGvpoaGLxM4mAEaLV7iAzQ3oU0IvD5x9ix3yF2RAAuYAOO2f7PEFWCXZ4C9Pb2UsgDeVnFSpbFK7/IWu7TPTvBqzbGdCHOJQSxiEjt6IyZmxQyEJHv6xyQsYk//moVFsN2zP6fRImjfq7/n/wFDguUQFNEwugAAAABJRU5ErkJggg==');
  }

  div.callout-important.callout-style-default .callout-title {
    background-color: #f7dddc
  }

  div.callout-warning {
    border-left-color: #f0ad4e !important;
  }

  div.callout-warning .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAAETklEQVRYCeVWW2gcVRg+58yaTUnizqbipZeX4uWhBEniBaoUX1Ioze52t7sRq6APio9V9MEaoWlVsFasRq0gltaAPuxms8lu0gcviE/FFOstVbSIxgcv6SU7EZqmdc7v9+9mJtNks51NTUH84ed889/PP+cmxP+d5FIbMJmNbpREu4WUkiTtCicKny0l1pIKmBzovF2S+hIJHX8iEu3hZJ5lNZGqyRrGSIQpq15AzF28jgpeY6yk6GVdrfFqdrD6Iw+QlB8g0YS2g7dyQmXM/IDhBhT0UCiRf59lfqmmDvzRt6kByV/m4JjtzuaujMUM2c5Z2d6JdKrRb3K2q6mA+oYVz8JnDdKPmmNthzkAk/lN63sYPgevrguc72aZX/L9C6x09GYyxBgCX4NlvyGUHOKELlm5rXeR1kchuChJt4SSwyddZRXgvwMGvYo4QSlk3/zkHD8UHxwVJA6zjZZqP8v8kK8OWLnIZtLyCAJagYC4rTGW/9Pqj92N/c+LUaAj27movwbi19tk/whRCIE7Q9vyI6yvRpftAKVTdUjOW40X3h5OXsKCdmFcx0xlLJoSuQngnrJe7Kcjm4OMq9FlC7CMmScQANuNvjfP3PjGXDBaUQmbp296S5L4DrpbrHN1T87ZVEZVCzg1FF0Ft+dKrlLukI+/c9ENo+TvlTDbYFvuKPtQ9+l052rXrgKoWkDAFnvh0wTOmYn8R5f4k/jN/fZiCM1tQx9jQQ4ANhqG4hiL0qIFTGViG9DKB7GYzgubnpofgYRwO+DFjh0Zin2m4b/97EDkXkc+f6xYAPX0KK2I/7fUQuwzuwo/L3AkcjugPNixC8cHf0FyPjWlItmLxWw4Ou9YsQCr5fijMGoD/zpdRy95HRysyXA74MWOnscpO4j2y3HAVisw85hX5+AFBRSHt4ShfLFkIMXTqyKFc46xdzQM6XbAi702a7sy04J0+feReMFKp5q9esYLCqAZYw/k14E/xcLLsFElaornTuJB0svMuJINy8xkIYuL+xPAlWRceH6+HX7THJ0djLUom46zREu7tTkxwmf/FdOZ/sh6Q8qvEAiHpm4PJ4a/doJe0gH1t+aHRgCzOvBvJedEK5OFE5jpm4AGP2a8Dxe3gGJ/pAutug9Gp6he92CsSsWBaEcxGx0FHytmIpuqGkOpldqNYQK8cSoXvd+xLxXADw0kf6UkJNFtdo5MOgaLjiQOQHcn+A6h5NuL2s0qsC2LOM75PcF3yr5STuBSAcGG+meA14K/CI21HcS4LBT6tv0QAh8Dr5l93AhZzG5ZJ4VxAqdZUEl9z7WJ4aN+svMvwHHL21UKTd1mqvChH7/Za5xzXBBKrUcB0TQ+Ulgkfbi/H/YT5EptrGzsEK7tR1B7ln9BBwckYfMiuSqklSznIuoIIOM42MQO+QnduCoFCI0bpkzjCjddHPN/F+2Yu+sd9bKNpVwHhbS3LluK/0zgfwD0xYI5dXuzlQAAAABJRU5ErkJggg==');
  }

  div.callout-warning.callout-style-default .callout-title {
    background-color: #fcefdc
  }

  div.callout-tip {
    border-left-color: #02b875 !important;
  }

  div.callout-tip .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAADr0lEQVRYCe1XTWgTQRj9ZjZV8a9SPIkKgj8I1bMHsUWrqYLVg4Ue6v9BwZOxSYsIerFao7UiUryIqJcqgtpimhbBXoSCVxUFe9CTiogUrUp2Pt+3aUI2u5vdNh4dmMzOzHvvezuz8xNFM0mjnbXaNu1MvFWRXkXEyE6aYOYJpdW4IXuA4r0fo8qqSMDBU0v1HJUgVieAXxzCsdE/YJTdFcVIZQNMyhruOMJKXYFoLfIfIvVIMWdsrd+Rpd86ZmyzzjJmLStqRn0v8lzkb4rVIXvnpScOJuAn2ACC65FkPzEdEy4TPWRLJ2h7z4cArXzzaOdKlbOvKKX25Wl00jSnrwVxAg3o4dRxhO13RBSdNvH0xSARv3adTXbBdTf64IWO2vH0LT+cv4GR1DJt+DUItaQogeBX/chhbTBxEiZ6gftlDNXTrvT7co4ub5A6gp9HIcHvzTa46OS5fBeP87Qm0fQkr4FsYgVQ7Qg+ZayaDg9jhg1GkWj8RG6lkeSacrrHgDaxdoBiZPg+NXV/KifMuB6//JmYH4CntVEHy/keA6x4h4CU5oFy8GzrBS18cLJMXcljAKB6INjWsRcuZBWVaS3GDrqB7rdapVIeA+isQ57Eev9eCqzqOa81CY05VLd6SamW2wA2H3SiTbnbSxmzfp7WtKZkqy4mdyAlGx7ennghYf8voqp9cLSgKdqNfa6RdRsAAkPwRuJZNbpByn+RrJi1RXTwdi8RQF6ymDwGMAtZ6TVE+4uoKh+MYkcLsT0Hk8eAienbiGdjJHZTpmNjlbFJNKDVAp2fJlYju6IreQxQ08UJDNYdoLSl6AadO+fFuCQqVMB1NJwPm69T04Wv5WhfcWyfXQB+wXRs1pt+nCknRa0LVzSA/2B+a9+zQJadb7IyyV24YAxKp2Jqs3emZTuNnKxsah+uabKbMk7CbTgJx/zIgQYErIeTKRQ9yD9wxVof5YolPHqaWo7TD6tJlh7jQnK5z2n3+fGdggIOx2kaa2YI9QWarc5Ce1ipNWMKeSG4DysFF52KBmTNMmn5HqCFkwy34rDg05gDwgH3bBi+sgFhN/e8QvRn8kbamCOhgrZ9GJhFDgfcMHzFb6BAtjKpFhzTjwv1KCVuxHvCbsSiEz4CANnj84cwHdFXAbAOJ4LTSAawGWFn5tDhLMYz6nWeU2wJfIhmIJBefcd/A5FWQWGgrWzyORZ3Q6HuV+Jf0Bj+BTX69fm1zWgK7By1YTXchFDORywnfQ7GpzOo6S+qECrsx2ifVQAAAABJRU5ErkJggg==');
  }

  div.callout-tip.callout-style-default .callout-title {
    background-color: #ccf1e3
  }

  div.callout-caution {
    border-left-color: #fd7e14 !important;
  }

  div.callout-caution .callout-icon::before {
    background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAAAXNSR0IArs4c6QAAAERlWElmTU0AKgAAAAgAAYdpAAQAAAABAAAAGgAAAAAAA6ABAAMAAAABAAEAAKACAAQAAAABAAAAIKADAAQAAAABAAAAIAAAAACshmLzAAACV0lEQVRYCdVWzWoUQRCuqp2ICBLJXgITZL1EfQDBW/bkzUMUD7klD+ATSHBEfAIfQO+iXsWDxJsHL96EHAwhgzlkg8nBg25XWb0zIb0zs9muYYWkoKeru+vn664fBqElyZNuyh167NXJ8Ut8McjbmEraKHkd7uAnAFku+VWdb3reSmRV8PKSLfZ0Gjn3a6Xlcq9YGb6tADjn+lUfTXtVmaZ1KwBIvFI11rRXlWlatwIAAv2asaa9mlB9wwygiDX26qaw1yYPzFXg2N1GgG0FMF8Oj+VIx7E/03lHx8UhvYyNZLN7BwSPgekXXLribw7w5/c8EF+DBK5idvDVYtEEwMeYefjjLAdEyQ3M9nfOkgnPTEkYU+sxMq0BxNR6jExrAI31H1rzvLEfRIdgcv1XEdj6QTQAS2wtstEALLG1yEZ3QhH6oDX7ExBSFEkFINXH98NTrme5IOaaA7kIfiu2L8A3qhH9zRbukdCqdsA98TdElyeMe5BI8Rs2xHRIsoTSSVFfCFCWGPn9XHb4cdobRIWABNf0add9jakDjQJpJ1bTXOJXnnRXHRf+dNL1ZV1MBRCXhMbaHqGI1JkKIL7+i8uffuP6wVQAzO7+qVEbF6NbS0LJureYcWXUUhH66nLR5rYmva+2tjRFtojkM2aD76HEGAD3tPtKM309FJg5j/K682ywcWJ3PASCcycH/22u+Bh7Aa0ehM2Fu4z0SAE81HF9RkB21c5bEn4Dzw+/qNOyXr3DCTQDMBOdhi4nAgiFDGCinIa2owCEChUwD8qzd03PG+qdW/4fDzjUMcE1ZpIAAAAASUVORK5CYII=');
  }

  div.callout-caution.callout-style-default .callout-title {
    background-color: #ffe5d0
  }

  </style>
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
<meta property="og:title" content="MATH167R - MATH167R: Prediction">
<meta property="og:site-name" content="MATH167R">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">MATH167R: Prediction</h1>

<div class="quarto-title-authors">
<div class="quarto-title-author">
<div class="quarto-title-author-name">
Peter Gao 
</div>
</div>
</div>

</section>
<section id="overview-of-today" class="slide level2">
<h2>Overview of today</h2>
<ol type="1">
<li>Training and Testing</li>
<li>Cross-validation</li>
<li>Statistical Prediction Algorithms</li>
</ol>
<p><strong>Goal:</strong> Learn the concepts, terminology, and techniques in statistical prediction.</p>
</section>
<section id="acknowledgement" class="slide level2">
<h2>Acknowledgement</h2>
<p>This lecture draws from Ryan Tibshirani’s <a href="http://www.stat.cmu.edu/~ryantibs/statcomp/lectures/prediction.html">Statistical Prediction lecture</a> for Statistical Computing at Carnegie Mellon University.</p>
</section>
<section>
<section id="training-and-testing" class="title-slide slide level1 center">
<h1>Training and Testing</h1>

</section>
<section id="recall-regression" class="slide level2">
<h2>Recall: Regression</h2>
<p>Assume we have some data:</p>
<ul>
<li><span class="math inline">\(X_1,\ldots, X_p\)</span>: <span class="math inline">\(p\)</span> <strong>independent variables/explanatory variables/covariates/predictors</strong></li>
<li><span class="math inline">\(Y\)</span>: the <strong>dependent variables/response/outcome</strong>.</li>
</ul>
<p>We want to know the relationship between our covariates and our response, we can do this with a method called <strong>regression</strong>. Regression provides us with a statistical method to conduct inference and prediction.</p>
<div class="fragment">
<p>What is the difference between inference and prediction?</p>
</div>
</section>
<section id="recall-regression-1" class="slide level2">
<h2>Recall: Regression</h2>
<ul>
<li><strong>inference:</strong> assess the relationship between our variables, our statistical model as a whole, predictor importance
<ul>
<li>What is the relationship between sleep and GPA?</li>
<li>Is parents’ education or parents’ income more important for explaining income?</li>
</ul></li>
<li><strong>prediction:</strong> predict new/future outcomes from new/future covariates
<ul>
<li>Can we predict test scores based on hours spent studying?</li>
</ul></li>
</ul>
</section>
<section id="linear-regression" class="slide level2">
<h2>Linear Regression</h2>
<p>Given our response <span class="math inline">\(Y\)</span> and our predictors <span class="math inline">\(X_1, \ldots, X_p\)</span>, a <strong>linear regression model</strong> takes the form:</p>
<p><span class="math display">\[
\begin{align}
Y &amp;= \beta_0 + \beta_1 X_1 + \cdots + \beta_p X_p + \epsilon,\\
\epsilon &amp;\sim N(0,\sigma^2)
\end{align}
\]</span></p>
<p>Previously, we focused on using this model for inference (e.g.&nbsp;<span class="math inline">\(H_0: \beta_1 = 0\)</span>). Today, we are shifting our focus to prediction.</p>
</section>
<section id="statistical-prediction" class="slide level2">
<h2>Statistical Prediction</h2>
<p>Often, we use a linear model even when we know that the assumptions for inference are broken: for example, when errors are not normally distributed.</p>
<p>Though the model may be wrong, it may still be useful for learning about the relationship between response and covariates.</p>
<p>In addition, we can use a working model for <strong>prediction</strong>.</p>
</section>
<section id="training-and-testing-data" class="slide level2">
<h2>Training and testing data</h2>
<p>When training predictive algorithms, it is common to split your data into two categories:</p>
<p><strong>Training data:</strong> data used to train/fit our model</p>
<p><strong>Test data:</strong> data used to evaluate/test the performance of our model</p>
<p>Suppose we have training data <span class="math inline">\(X_{i1}, \ \ldots,\ X_{ip}, Y_i, \ i = 1,\ldots,n\)</span> which we use to estimate regression coefficents <span class="math inline">\(\hat\beta_0, \ \hat\beta_1, \ldots \hat\beta_p\)</span> (Recall: we use <span class="math inline">\(\hat{}\)</span> “hats” to indicate <strong>estimates</strong>).</p>
</section>
<section id="making-predictions" class="slide level2">
<h2>Making predictions</h2>
<p>Now suppose we are given new testing data <span class="math inline">\(X^*_1,\ \ldots, X^*_{p}\)</span> and asked to predict the associated <span class="math inline">\(Y^∗\)</span>. Using our estimated linear model, the prediction is: <span class="math display">\[\widehat{Y}^* = \hat\beta_0 + \hat{\beta}_1 X^*_1 + \cdots + \hat{\beta}_p X^*_p\]</span></p>
<p>Given our prediction</p>
<p><span class="math display">\[\hat{Y} = \hat\beta_0 + \hat{\beta}_1 X^*_1 + \cdots + \hat{\beta}_p X^*_p\]</span> We define the <strong>mean squared error</strong>, or <strong>mean squared prediction error</strong>, as</p>
<p><span class="math display">\[\mathbb{E}[(Y^* -\hat{Y}^*)^2].\]</span></p>
<p>In other words, the test error is defined as the expected squared difference between a new prediction and the truth, where the expectation is taken over the population distribution of test data.</p>
</section>
<section id="test-error" class="slide level2">
<h2>Test error</h2>
<p><strong>Mean squared prediction error:</strong> <span class="math inline">\(\mathbb{E}[(Y^* -\hat{Y}^*)^2],\)</span> the expected squared difference between a new prediction and the truth.</p>
<p>The MSPE quantifies the predictive power of our model, but we do not actually have access to the full poulation distribution.</p>
<p>As such, we must estimate the MSPE using our data in order to use it to assess our model.</p>
<p>In particular, we could use the MSPE for:</p>
<ul>
<li><strong>predictive assessment:</strong> understanding the magnitude of errors we should expect when making future predictions</li>
<li><strong>model/method selection:</strong> choosing among multiple candidate models.</li>
</ul>
</section>
<section id="training-error" class="slide level2">
<h2>Training Error</h2>
<p>A natural estimator for the test error might be the observed average <strong>training error:</strong></p>
<p><span class="math display">\[\dfrac{1}{n}\sum_{i=1}^n (Y_i - \hat{Y}_i)^2.\]</span></p>
<p>Can you think of a problem with this approach?</p>
<div class="fragment">
<p>In general, this will be <em>too optimistic</em>. Why? We obtained parameter estimates <span class="math inline">\(\widehat{\beta}_0,\ \ldots,\ \widehat{\beta}_p\)</span> based on our training data.</p>
</div>
</section>
<section id="training-error-1" class="slide level2">
<h2>Training Error</h2>
<p>More specifically (with a linear regression model), we chose parameters to minimize the squared errors (hence, least squares).</p>
<p>We cannot expect this error rate to generalize to test data.</p>
<p>Critically, the more complex our model, the more optimistic our training data will be as an estimate for our test data</p>
</section>
<section id="example-training-error-vs-test-error" class="slide level2">
<h2>Example: Training Error vs Test Error</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="co"># generate data</span></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="fu">set.seed</span>(<span class="dv">302</span>)</span>
<span id="cb1-4"><a href="#cb1-4"></a>n <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb1-5"><a href="#cb1-5"></a>x <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">runif</span>(n, <span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>))</span>
<span id="cb1-6"><a href="#cb1-6"></a>y <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>x <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">rnorm</span>(n)</span>
<span id="cb1-7"><a href="#cb1-7"></a>x_test <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">runif</span>(n, <span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>))</span>
<span id="cb1-8"><a href="#cb1-8"></a>y_test <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>x_test <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">rnorm</span>(n)</span>
<span id="cb1-9"><a href="#cb1-9"></a>df_train <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">"x"</span> <span class="ot">=</span> x, <span class="st">"y"</span> <span class="ot">=</span> y)</span>
<span id="cb1-10"><a href="#cb1-10"></a>df_test <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">"x"</span> <span class="ot">=</span> x_test, <span class="st">"y"</span> <span class="ot">=</span> y_test)</span>
<span id="cb1-11"><a href="#cb1-11"></a></span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="co"># store a theme</span></span>
<span id="cb1-13"><a href="#cb1-13"></a>my_theme <span class="ot">&lt;-</span> <span class="fu">theme_bw</span>(<span class="at">base_size =</span> <span class="dv">16</span>) <span class="sc">+</span> </span>
<span id="cb1-14"><a href="#cb1-14"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">face =</span> <span class="st">"bold"</span>),</span>
<span id="cb1-15"><a href="#cb1-15"></a>        <span class="at">plot.subtitle =</span> <span class="fu">element_text</span>(<span class="at">hjust =</span> <span class="fl">0.5</span>))</span>
<span id="cb1-16"><a href="#cb1-16"></a></span>
<span id="cb1-17"><a href="#cb1-17"></a><span class="co"># generate plots</span></span>
<span id="cb1-18"><a href="#cb1-18"></a>g_train <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_train, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb1-19"><a href="#cb1-19"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="fu">min</span>(y, y_test), <span class="fu">max</span>(y, y_test)) <span class="sc">+</span> </span>
<span id="cb1-20"><a href="#cb1-20"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Training Data"</span>) <span class="sc">+</span> my_theme</span>
<span id="cb1-21"><a href="#cb1-21"></a>g_test <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(df_test, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb1-22"><a href="#cb1-22"></a>  <span class="fu">xlim</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>) <span class="sc">+</span> <span class="fu">ylim</span>(<span class="fu">min</span>(y, y_test), <span class="fu">max</span>(y, y_test)) <span class="sc">+</span> </span>
<span id="cb1-23"><a href="#cb1-23"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Test Data"</span>) <span class="sc">+</span> my_theme</span>
<span id="cb1-24"><a href="#cb1-24"></a><span class="fu">ggarrange</span>(g_train, g_test) <span class="co"># from ggpubr, to put side-by-side</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="example-training-error-vs-test-error-1" class="slide level2">
<h2>Example: Training Error vs Test Error</h2>

<img data-src="26_prediction_files/figure-revealjs/unnamed-chunk-2-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="example-training-error-vs-test-error-2" class="slide level2">
<h2>Example: Training Error vs Test Error</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="co"># Fit linear model and calculate training error</span></span>
<span id="cb2-2"><a href="#cb2-2"></a>lm_fit <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df_train)</span>
<span id="cb2-3"><a href="#cb2-3"></a>yhat_train <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm_fit)</span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="co"># (y_i - yhat_i)^2</span></span>
<span id="cb2-5"><a href="#cb2-5"></a>train_err <span class="ot">&lt;-</span> <span class="fu">mean</span>((df_train<span class="sc">$</span>y <span class="sc">-</span> yhat_train)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb2-6"><a href="#cb2-6"></a></span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="co"># Calculate testing error</span></span>
<span id="cb2-8"><a href="#cb2-8"></a>yhat_test <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm_fit, <span class="fu">data.frame</span>(<span class="at">x =</span> df_test<span class="sc">$</span>x))</span>
<span id="cb2-9"><a href="#cb2-9"></a>test_err <span class="ot">&lt;-</span> <span class="fu">mean</span>((df_test<span class="sc">$</span>y <span class="sc">-</span> yhat_test)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb2-10"><a href="#cb2-10"></a></span>
<span id="cb2-11"><a href="#cb2-11"></a><span class="co"># Add linear model and error text to plot</span></span>
<span id="cb2-12"><a href="#cb2-12"></a>g_train2 <span class="ot">&lt;-</span> g_train <span class="sc">+</span> </span>
<span id="cb2-13"><a href="#cb2-13"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Training error:"</span>, <span class="fu">round</span>(train_err, <span class="dv">3</span>))) <span class="sc">+</span></span>
<span id="cb2-14"><a href="#cb2-14"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">fitted</span>(lm_fit)), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="fl">1.5</span>)</span>
<span id="cb2-15"><a href="#cb2-15"></a>g_test2 <span class="ot">&lt;-</span> g_test <span class="sc">+</span> </span>
<span id="cb2-16"><a href="#cb2-16"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Test error:"</span>, <span class="fu">round</span>(test_err, <span class="dv">3</span>))) <span class="sc">+</span></span>
<span id="cb2-17"><a href="#cb2-17"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">y =</span> <span class="fu">fitted</span>(lm_fit), <span class="at">x =</span> df_train<span class="sc">$</span>x), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="fl">1.5</span>)</span>
<span id="cb2-18"><a href="#cb2-18"></a></span>
<span id="cb2-19"><a href="#cb2-19"></a><span class="fu">ggarrange</span>(g_train2, g_test2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="example-training-error-vs-test-error-for-linear-model" class="slide level2">
<h2>Example: Training Error vs Test Error for linear model</h2>

<img data-src="26_prediction_files/figure-revealjs/unnamed-chunk-4-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="example-degree-5-polynomial" class="slide level2">
<h2>Example: Degree 5 polynomial</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="co"># Fit 5 degree polynomial and calculate training error</span></span>
<span id="cb3-2"><a href="#cb3-2"></a>lm_fit_5 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="dv">5</span>), <span class="at">data =</span> df_train)</span>
<span id="cb3-3"><a href="#cb3-3"></a>yhat_train_5 <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm_fit_5)</span>
<span id="cb3-4"><a href="#cb3-4"></a>train_err_5 <span class="ot">&lt;-</span> <span class="fu">mean</span>((df_train<span class="sc">$</span>y <span class="sc">-</span> yhat_train_5)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb3-5"><a href="#cb3-5"></a></span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="co"># Calculate testing error</span></span>
<span id="cb3-7"><a href="#cb3-7"></a>yhat_test_5 <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm_fit_5, <span class="fu">data.frame</span>(<span class="at">x =</span> df_test<span class="sc">$</span>x))</span>
<span id="cb3-8"><a href="#cb3-8"></a>test_err_5 <span class="ot">&lt;-</span> <span class="fu">mean</span>((df_test<span class="sc">$</span>y <span class="sc">-</span> yhat_test_5)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb3-9"><a href="#cb3-9"></a></span>
<span id="cb3-10"><a href="#cb3-10"></a><span class="co"># Create smooth line for plotting</span></span>
<span id="cb3-11"><a href="#cb3-11"></a>x_fit <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">length =</span> <span class="dv">100</span>))</span>
<span id="cb3-12"><a href="#cb3-12"></a>line_fit <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x_fit, <span class="at">y =</span> <span class="fu">predict</span>(lm_fit_5, <span class="at">newdata =</span> x_fit))</span>
<span id="cb3-13"><a href="#cb3-13"></a>                       </span>
<span id="cb3-14"><a href="#cb3-14"></a><span class="co"># Add linear model and error text to plot</span></span>
<span id="cb3-15"><a href="#cb3-15"></a>g_train3 <span class="ot">&lt;-</span> g_train <span class="sc">+</span> </span>
<span id="cb3-16"><a href="#cb3-16"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Training error:"</span>, <span class="fu">round</span>(train_err_5, <span class="dv">3</span>))) <span class="sc">+</span></span>
<span id="cb3-17"><a href="#cb3-17"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> line_fit, <span class="fu">aes</span>(<span class="at">y =</span> y, <span class="at">x =</span> x), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="fl">1.5</span>)</span>
<span id="cb3-18"><a href="#cb3-18"></a>g_test3 <span class="ot">&lt;-</span> g_test <span class="sc">+</span> </span>
<span id="cb3-19"><a href="#cb3-19"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Test error:"</span>, <span class="fu">round</span>(test_err_5, <span class="dv">3</span>))) <span class="sc">+</span></span>
<span id="cb3-20"><a href="#cb3-20"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> line_fit, <span class="fu">aes</span>(<span class="at">y =</span> y, <span class="at">x =</span> x), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="fl">1.5</span>)</span>
<span id="cb3-21"><a href="#cb3-21"></a></span>
<span id="cb3-22"><a href="#cb3-22"></a><span class="fu">ggarrange</span>(g_train3, g_test3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="example-degree-5-polynomial-1" class="slide level2">
<h2>Example: Degree 5 polynomial</h2>

<img data-src="26_prediction_files/figure-revealjs/unnamed-chunk-6-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="example-degree-10-polynomial" class="slide level2">
<h2>Example: Degree 10 polynomial</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co"># Fit 10 degree polynomial and calculate training error</span></span>
<span id="cb4-2"><a href="#cb4-2"></a>lm_fit_10 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="dv">10</span>), <span class="at">data =</span> df_train)</span>
<span id="cb4-3"><a href="#cb4-3"></a>yhat_train_10 <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm_fit_10)</span>
<span id="cb4-4"><a href="#cb4-4"></a>train_err_10 <span class="ot">&lt;-</span> <span class="fu">mean</span>((df_train<span class="sc">$</span>y <span class="sc">-</span> yhat_train_10)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb4-5"><a href="#cb4-5"></a></span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="co"># Calculate testing error</span></span>
<span id="cb4-7"><a href="#cb4-7"></a>yhat_test_10 <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm_fit_10, <span class="fu">data.frame</span>(<span class="at">x =</span> df_test<span class="sc">$</span>x))</span>
<span id="cb4-8"><a href="#cb4-8"></a>test_err_10 <span class="ot">&lt;-</span> <span class="fu">mean</span>((df_test<span class="sc">$</span>y <span class="sc">-</span> yhat_test_10)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb4-9"><a href="#cb4-9"></a></span>
<span id="cb4-10"><a href="#cb4-10"></a><span class="co"># Create smooth line for plotting</span></span>
<span id="cb4-11"><a href="#cb4-11"></a>x_fit <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">length =</span> <span class="dv">100</span>))</span>
<span id="cb4-12"><a href="#cb4-12"></a>line_fit <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x_fit, <span class="at">y =</span> <span class="fu">predict</span>(lm_fit_10, <span class="at">newdata =</span> x_fit))</span>
<span id="cb4-13"><a href="#cb4-13"></a>                       </span>
<span id="cb4-14"><a href="#cb4-14"></a><span class="co"># Add linear model and error text to plot</span></span>
<span id="cb4-15"><a href="#cb4-15"></a>g_train4 <span class="ot">&lt;-</span> g_train <span class="sc">+</span> </span>
<span id="cb4-16"><a href="#cb4-16"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Training error:"</span>, <span class="fu">round</span>(train_err_10, <span class="dv">3</span>))) <span class="sc">+</span></span>
<span id="cb4-17"><a href="#cb4-17"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> line_fit, <span class="fu">aes</span>(<span class="at">y =</span> y, <span class="at">x =</span> x), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="fl">1.5</span>)</span>
<span id="cb4-18"><a href="#cb4-18"></a>g_test4 <span class="ot">&lt;-</span> g_test <span class="sc">+</span> </span>
<span id="cb4-19"><a href="#cb4-19"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Test error:"</span>, <span class="fu">round</span>(test_err_10, <span class="dv">3</span>))) <span class="sc">+</span></span>
<span id="cb4-20"><a href="#cb4-20"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> line_fit, <span class="fu">aes</span>(<span class="at">y =</span> y, <span class="at">x =</span> x), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="fl">1.5</span>)</span>
<span id="cb4-21"><a href="#cb4-21"></a></span>
<span id="cb4-22"><a href="#cb4-22"></a><span class="fu">ggarrange</span>(g_train4, g_test4)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="example-degree-10-polynomial-1" class="slide level2">
<h2>Example: Degree 10 polynomial</h2>

<img data-src="26_prediction_files/figure-revealjs/unnamed-chunk-8-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="example-degree-15-polynomial" class="slide level2">
<h2>Example: Degree 15 polynomial</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="co"># Fit 15 degree polynomial and calculate training error</span></span>
<span id="cb5-2"><a href="#cb5-2"></a>lm_fit_15 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="dv">15</span>), <span class="at">data =</span> df_train)</span>
<span id="cb5-3"><a href="#cb5-3"></a>yhat_train_15 <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm_fit_15)</span>
<span id="cb5-4"><a href="#cb5-4"></a>train_err_15 <span class="ot">&lt;-</span> <span class="fu">mean</span>((df_train<span class="sc">$</span>y <span class="sc">-</span> yhat_train_15)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb5-5"><a href="#cb5-5"></a></span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="co"># Calculate testing error</span></span>
<span id="cb5-7"><a href="#cb5-7"></a>yhat_test_15 <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm_fit_15, <span class="fu">data.frame</span>(<span class="at">x =</span> df_test<span class="sc">$</span>x))</span>
<span id="cb5-8"><a href="#cb5-8"></a>test_err_15 <span class="ot">&lt;-</span> <span class="fu">mean</span>((df_test<span class="sc">$</span>y <span class="sc">-</span> yhat_test_15)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb5-9"><a href="#cb5-9"></a></span>
<span id="cb5-10"><a href="#cb5-10"></a><span class="co"># Create smooth line for plotting</span></span>
<span id="cb5-11"><a href="#cb5-11"></a>x_fit <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">length =</span> <span class="dv">100</span>))</span>
<span id="cb5-12"><a href="#cb5-12"></a>line_fit <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x_fit, <span class="at">y =</span> <span class="fu">predict</span>(lm_fit_15, <span class="at">newdata =</span> x_fit))</span>
<span id="cb5-13"><a href="#cb5-13"></a>                       </span>
<span id="cb5-14"><a href="#cb5-14"></a><span class="co"># Add linear model and error text to plot</span></span>
<span id="cb5-15"><a href="#cb5-15"></a>g_train5 <span class="ot">&lt;-</span> g_train <span class="sc">+</span> </span>
<span id="cb5-16"><a href="#cb5-16"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Training error:"</span>, <span class="fu">round</span>(train_err_15, <span class="dv">3</span>))) <span class="sc">+</span></span>
<span id="cb5-17"><a href="#cb5-17"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> line_fit, <span class="fu">aes</span>(<span class="at">y =</span> y, <span class="at">x =</span> x), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="fl">1.5</span>)</span>
<span id="cb5-18"><a href="#cb5-18"></a>g_test5 <span class="ot">&lt;-</span> g_test <span class="sc">+</span> </span>
<span id="cb5-19"><a href="#cb5-19"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Test error:"</span>, <span class="fu">round</span>(test_err_15, <span class="dv">3</span>))) <span class="sc">+</span></span>
<span id="cb5-20"><a href="#cb5-20"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> line_fit, <span class="fu">aes</span>(<span class="at">y =</span> y, <span class="at">x =</span> x), <span class="at">col =</span> <span class="st">"red"</span>, <span class="at">lwd =</span> <span class="fl">1.5</span>)</span>
<span id="cb5-21"><a href="#cb5-21"></a></span>
<span id="cb5-22"><a href="#cb5-22"></a><span class="fu">ggarrange</span>(g_train5, g_test5)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="example-degree-15-polynomial-1" class="slide level2">
<h2>Example: Degree 15 polynomial</h2>

<img data-src="26_prediction_files/figure-revealjs/unnamed-chunk-10-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="bias-variance-tradeoff" class="slide level2">
<h2>Bias-Variance Tradeoff</h2>
<p>The formula for test error can be decomposed as a function of the bias and variance of our estimates.</p>
<ul>
<li><p><strong>Bias:</strong> the expected difference between our estimate and the truth</p></li>
<li><p><strong>Variance:</strong> the variability of our estimate of the truth</p></li>
</ul>
</section>
<section id="bias-variance-tradeoff-1" class="slide level2">
<h2>Bias-Variance Tradeoff</h2>
<p>For example, suppose <span class="math inline">\(Y^*=\mu+\epsilon\)</span> where <span class="math inline">\(\epsilon\)</span> is mean zero random error with variance <span class="math inline">\(\sigma^2\)</span>:</p>
<p><span class="math display">\[\begin{align}\mathbb{E}[(Y^* -\hat{Y}^*)^2]&amp;=\mathbb{E}(Y^{*2})-2\mathbb{E}(Y^*\hat{Y}^*)+\mathbb{E}(\hat{Y}^{*2})\\
&amp;=\mu^2+\sigma^2-2\mu\mathbb{E}(\hat{Y}^*)+\mathrm{Var}(\hat{Y}^{*})+\mathbb{E}(\hat{Y}^{*2})\\
&amp;=(\mu -\mathbb{E}(\hat{Y}^*))^2+\sigma^2+\mathrm{Var}(\hat{Y}^{*}) \end{align}\]</span></p>
</section>
<section id="bias-variance-tradeoff-2" class="slide level2">
<h2>Bias-Variance Tradeoff</h2>
<p><img src="images/bvtradeoff.png" height="500"></p>
<p>Image Credit: An Introduction to Statistical Learning by Gareth James, Daniela Witten, Trevor Hastie, Robert Tibshirani</p>
</section>
<section id="bias-variance-tradeoff-3" class="slide level2">
<h2>Bias-Variance Tradeoff</h2>
<ul>
<li><p><strong>Bias:</strong> underfitting, error from missing relevant relationships</p></li>
<li><p><strong>Variance:</strong> overfitting, error from high sensitivity</p></li>
</ul>
<p><img src="images/underover1.png" height="300"></p>
<p><a href="https://medium.com/greyatom/what-is-underfitting-and-overfitting-in-machine-learning-and-how-to-deal-with-it-6803a989c76">Image Source</a></p>
</section>
<section id="bias-variance-tradeoff-4" class="slide level2">
<h2>Bias-Variance Tradeoff</h2>
<p><img src="images/underover2.png" height="300"></p>
<p><a href="https://medium.com/greyatom/what-is-underfitting-and-overfitting-in-machine-learning-and-how-to-deal-with-it-6803a989c76">Image Source</a></p>
</section>
<section id="bias-variance-tradeoff-5" class="slide level2">
<h2>Bias-Variance Tradeoff</h2>
<p>It is easy to fit a model with extremely low variance and extremely high bias, or extremely low bias and extremely high variance, but these models will not have a good test error. Ideally, we would like an estimate that has both low bias and low variance, but this is not always possible!</p>
<p>As a general rule of thumb, as we increase the complexity of our model, the bias will decrease but the variance will increase. You can think of our bias decreasing because we are training our model to be more specific to our training data. You can think of the variance increasing because our model will be overfit, and will vary substantially with new training data.</p>
</section></section>
<section>
<section id="cross-validation" class="title-slide slide level1 center">
<h1>Cross-validation</h1>

</section>
<section id="sample-splitting" class="slide level2">
<h2>Sample-splitting</h2>
<p>Where do we get our “training data” and our “test data” in practice? We can’t just simulate more data for our test data in the real world. In practice, we use a technique called <strong>sample-splitting:</strong></p>
<ol type="1">
<li>Split the data set into two (or more…) parts</li>
<li>First part of data: train the model/method</li>
<li>Second part of data: make predictions</li>
<li>Evaluate observed test error</li>
</ol>
</section>
<section id="sample-splitting-1" class="slide level2">
<h2>Sample-splitting</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="fu">library</span>(forcats)</span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="co"># Generate data</span></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="fu">set.seed</span>(<span class="dv">302</span>)</span>
<span id="cb6-4"><a href="#cb6-4"></a>n <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb6-5"><a href="#cb6-5"></a>x <span class="ot">&lt;-</span> <span class="fu">sort</span>(<span class="fu">runif</span>(n, <span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>))</span>
<span id="cb6-6"><a href="#cb6-6"></a>y <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">*</span>x <span class="sc">+</span> <span class="dv">2</span><span class="sc">*</span><span class="fu">rnorm</span>(n)</span>
<span id="cb6-7"><a href="#cb6-7"></a></span>
<span id="cb6-8"><a href="#cb6-8"></a><span class="co"># Randomly split data into two parts</span></span>
<span id="cb6-9"><a href="#cb6-9"></a>inds <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="at">length =</span> n))</span>
<span id="cb6-10"><a href="#cb6-10"></a>split <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(inds) <span class="sc">%&gt;%</span></span>
<span id="cb6-11"><a href="#cb6-11"></a>  <span class="fu">fct_recode</span>(<span class="at">Training =</span> <span class="st">"1"</span>, <span class="at">Test =</span> <span class="st">"2"</span>)</span>
<span id="cb6-12"><a href="#cb6-12"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">"x"</span> <span class="ot">=</span> x, <span class="st">"y"</span> <span class="ot">=</span> y, <span class="st">"split"</span> <span class="ot">=</span> split)</span>
<span id="cb6-13"><a href="#cb6-13"></a></span>
<span id="cb6-14"><a href="#cb6-14"></a>g_split <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">color =</span> split)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb6-15"><a href="#cb6-15"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Sample-splitting"</span>) <span class="sc">+</span> my_theme</span>
<span id="cb6-16"><a href="#cb6-16"></a>g_split</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="sample-splitting-2" class="slide level2">
<h2>Sample-splitting</h2>

<img data-src="26_prediction_files/figure-revealjs/unnamed-chunk-12-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="sample-splitting-3" class="slide level2">
<h2>Sample-splitting</h2>
<div class="cell" data-layout-align="center">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># Train on the training split</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>data_train <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> <span class="fu">filter</span>(split <span class="sc">==</span> <span class="st">"Training"</span>)</span>
<span id="cb7-3"><a href="#cb7-3"></a>lm_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> data_train)</span>
<span id="cb7-4"><a href="#cb7-4"></a>lm_10 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="dv">10</span>), <span class="at">data =</span> data_train)</span>
<span id="cb7-5"><a href="#cb7-5"></a></span>
<span id="cb7-6"><a href="#cb7-6"></a><span class="co"># Predict on the second half</span></span>
<span id="cb7-7"><a href="#cb7-7"></a>data_test <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(split <span class="sc">==</span> <span class="st">"Test"</span>)</span>
<span id="cb7-8"><a href="#cb7-8"></a>pred_1 <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm_1, <span class="fu">data.frame</span>(<span class="at">x =</span> data_test<span class="sc">$</span>x))</span>
<span id="cb7-9"><a href="#cb7-9"></a>pred_10 <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm_10, <span class="fu">data.frame</span>(<span class="at">x =</span> data_test<span class="sc">$</span>x))</span>
<span id="cb7-10"><a href="#cb7-10"></a></span>
<span id="cb7-11"><a href="#cb7-11"></a><span class="co"># Calculate test error</span></span>
<span id="cb7-12"><a href="#cb7-12"></a>test_err_1 <span class="ot">&lt;-</span> <span class="fu">mean</span>((data_test<span class="sc">$</span>y <span class="sc">-</span> pred_1)<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb7-13"><a href="#cb7-13"></a>test_err_10 <span class="ot">&lt;-</span> <span class="fu">mean</span>((data_test<span class="sc">$</span>y <span class="sc">-</span> pred_10)<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="sample-splitting-4" class="slide level2">
<h2>Sample-splitting</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="co"># Create smooth lines for plotting</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>x_fit <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="fu">min</span>(data<span class="sc">$</span>x), <span class="fu">max</span>(data<span class="sc">$</span>x), <span class="at">length =</span> <span class="dv">100</span>))</span>
<span id="cb8-3"><a href="#cb8-3"></a>line_fit_1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x_fit, <span class="at">y =</span> <span class="fu">predict</span>(lm_1, <span class="at">newdata =</span> x_fit))</span>
<span id="cb8-4"><a href="#cb8-4"></a>line_fit_10 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x_fit, <span class="at">y =</span> <span class="fu">predict</span>(lm_10, <span class="at">newdata =</span> x_fit))</span>
<span id="cb8-5"><a href="#cb8-5"></a>                       </span>
<span id="cb8-6"><a href="#cb8-6"></a><span class="co"># Add linear model and error text to plot</span></span>
<span id="cb8-7"><a href="#cb8-7"></a>g_split1 <span class="ot">&lt;-</span> g_split <span class="sc">+</span> </span>
<span id="cb8-8"><a href="#cb8-8"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Degree 1 Test error:"</span>, <span class="fu">round</span>(test_err_1, <span class="dv">3</span>))) <span class="sc">+</span></span>
<span id="cb8-9"><a href="#cb8-9"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> line_fit_1, <span class="fu">aes</span>(<span class="at">y =</span> y, <span class="at">x =</span> x), <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">lwd =</span> <span class="fl">1.5</span>)</span>
<span id="cb8-10"><a href="#cb8-10"></a>g_split10 <span class="ot">&lt;-</span> g_split <span class="sc">+</span> </span>
<span id="cb8-11"><a href="#cb8-11"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Degree 10 Test error:"</span>, <span class="fu">round</span>(test_err_10, <span class="dv">3</span>))) <span class="sc">+</span></span>
<span id="cb8-12"><a href="#cb8-12"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> line_fit_10, <span class="fu">aes</span>(<span class="at">y =</span> y, <span class="at">x =</span> x), <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">lwd =</span> <span class="fl">1.5</span>)</span>
<span id="cb8-13"><a href="#cb8-13"></a></span>
<span id="cb8-14"><a href="#cb8-14"></a><span class="fu">ggarrange</span>(g_split1, g_split10, <span class="at">common.legend =</span> <span class="cn">TRUE</span>, <span class="at">legend =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="sample-splitting-5" class="slide level2">
<h2>Sample-splitting</h2>

<img data-src="26_prediction_files/figure-revealjs/unnamed-chunk-15-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="sample-splitting-6" class="slide level2">
<h2>Sample-splitting</h2>
<p>Sample-splitting gives us a powerful tool to evaluate the performance of estimator <em>on data that was not used to train it</em>. Of course, this comes at the cost of sacrificing some of our data that could be used in order to train a model with as much information as possible, but this is a sacrifice we must make in practice if we want to appropriately evaluate the predictive performance of our models/methods!</p>
<p>However, we can do better than just splitting our data in half.</p>
</section>
<section id="k-fold-cross-validation" class="slide level2">
<h2>k-fold Cross-validation</h2>
<p>In general, the process of <span class="math inline">\(k\)</span>-fold cross-validation is as follows:</p>
<ol type="1">
<li>Split data into <span class="math inline">\(k\)</span> parts (folds)</li>
<li>Use all but 1 fold as your training data and fit the model</li>
<li>Use the remaining fold for your test data and make predictions</li>
<li>Switch which fold is your test data and repeat steps 2 and 3 until all folds have been test data (k times)</li>
<li>Compute squared error</li>
</ol>
<p>Commonly, we use <span class="math inline">\(k=5\)</span> and <span class="math inline">\(k=10\)</span>.</p>
</section>
<section id="k-fold-cross-validation-1" class="slide level2">
<h2>k-fold Cross-validation</h2>

<img data-src="images/cv.png" class="r-stretch quarto-figure-center"></section>
<section id="k-fold-cross-validation-2" class="slide level2">
<h2>k-fold Cross-validation</h2>
<p>For each split, we calculate the out-of-sample mean squared prediction error. For example, for the first split, we calculate</p>
<p><span class="math display">\[MSE_1 = \dfrac{1}{m}\sum_{j = 1}^{m} (Y_{j,test} - \hat{Y}_{j,test})^2,\]</span> where <span class="math inline">\(m\)</span> is the number of observations in the test set.</p>
<p>Then we calculate the <strong>cross-validation estimate</strong> of our test error</p>
<p><span class="math display">\[CV_{(k)} = \dfrac{1}{k}\sum_{i=1}^{k}MSE_i.\]</span></p>
<p>In words, our cross-validation estimate of the test error is the average of the mean squared errors across the splits!</p>
</section>
<section id="leave-one-out-cross-validation" class="slide level2">
<h2>Leave-One-Out Cross-Validation</h2>
<p>Leave-one-out cross-validation (LOOCV) is a special instance of <span class="math inline">\(k\)</span>-fold cross-validation where <span class="math inline">\(k\)</span> is equal to the sample size <span class="math inline">\(n\)</span>. This means you fit <span class="math inline">\(n\)</span> different models using <span class="math inline">\(n-1\)</span> data points for your training data, and then test on the remaining individual data point.</p>
</section>
<section id="bias-variance-tradeoff-6" class="slide level2">
<h2>Bias-variance Tradeoff</h2>
<p>LOOCV strengths in that it uses as much data as possible to train the model while still having out-of-sample test data. Thus, it will provide approximately unbiased estimates of the test error, and is the best choice for minimizing bias.</p>
<p>However, LOOCV has one major drawback: variance. Because it fits <span class="math inline">\(n\)</span> models, each of which is trained on almost identical training data, the outputs of the models are highly correlated. All other things being equal, the mean of correlated observations has a higher variance than the mean of uncorrelated observations. Thus, LOOCV has higher variance than <span class="math inline">\(k\)</span>-fold CV with <span class="math inline">\(k&lt;n\)</span>.</p>
<p>As a rule of thumb, stick to <span class="math inline">\(k=5\)</span> and <span class="math inline">\(k=10\)</span>. These values tend to result in an ideal balance in terms of the bias-variance tradeoff.</p>
</section>
<section id="what-to-do-after-cross-validation" class="slide level2">
<h2>What to do after cross-validation?</h2>
<p>We use cross-validation as a method to evaluate our model, <em>not</em> to build our model! Thus, once we have used <span class="math inline">\(k\)</span>-fold cross-validation to come up with a reasonable estimate of our out-of-sample test-error (and perhaps to choose among several models based on this test error), we use the <em>full</em> data to train our final predictive model.</p>
<p>Thus, using cross-validation, we are able to build a model based on our full data, and still evaluate the performance of our model on out-of-sample data!</p>
</section>
<section id="k-fold-cross-validation-example" class="slide level2">
<h2>k-fold Cross-validation Example</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="fu">set.seed</span>(<span class="dv">302</span>)</span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="co"># Split data in 5 parts, randomly</span></span>
<span id="cb9-3"><a href="#cb9-3"></a>k <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb9-4"><a href="#cb9-4"></a>inds <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>k, <span class="at">length =</span> n))</span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="co"># Use data from before</span></span>
<span id="cb9-6"><a href="#cb9-6"></a>data <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="st">"x"</span> <span class="ot">=</span> x, <span class="st">"y"</span> <span class="ot">=</span> y, <span class="st">"split"</span> <span class="ot">=</span> inds)</span>
<span id="cb9-7"><a href="#cb9-7"></a></span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="co"># Empty matrix to store predictions, 2 columns for 2 models</span></span>
<span id="cb9-9"><a href="#cb9-9"></a>pred_mat <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, n, <span class="dv">2</span>)</span>
<span id="cb9-10"><a href="#cb9-10"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k) {</span>
<span id="cb9-11"><a href="#cb9-11"></a>  data_train <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(split <span class="sc">!=</span> i)</span>
<span id="cb9-12"><a href="#cb9-12"></a>  data_test <span class="ot">&lt;-</span> data <span class="sc">|&gt;</span> dplyr<span class="sc">::</span><span class="fu">filter</span>(split <span class="sc">==</span> i)</span>
<span id="cb9-13"><a href="#cb9-13"></a>  </span>
<span id="cb9-14"><a href="#cb9-14"></a>  <span class="co"># Train our models</span></span>
<span id="cb9-15"><a href="#cb9-15"></a>  lm_1_cv <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> data_train)</span>
<span id="cb9-16"><a href="#cb9-16"></a>  lm_10_cv <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="dv">10</span>), <span class="at">data =</span> data_train)</span>
<span id="cb9-17"><a href="#cb9-17"></a>  </span>
<span id="cb9-18"><a href="#cb9-18"></a>  <span class="co"># Record predictions</span></span>
<span id="cb9-19"><a href="#cb9-19"></a>  pred_mat[inds <span class="sc">==</span> i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm_1_cv, <span class="fu">data.frame</span>(<span class="at">x =</span> data_test<span class="sc">$</span>x))</span>
<span id="cb9-20"><a href="#cb9-20"></a>  pred_mat[inds <span class="sc">==</span> i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">predict</span>(lm_10_cv, <span class="fu">data.frame</span>(<span class="at">x =</span> data_test<span class="sc">$</span>x))</span>
<span id="cb9-21"><a href="#cb9-21"></a>}</span>
<span id="cb9-22"><a href="#cb9-22"></a></span>
<span id="cb9-23"><a href="#cb9-23"></a><span class="co"># Compute average MSE to get CV error</span></span>
<span id="cb9-24"><a href="#cb9-24"></a>cv_err <span class="ot">&lt;-</span> <span class="fu">colMeans</span>((pred_mat <span class="sc">-</span> data<span class="sc">$</span>y)<span class="sc">^</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="k-fold-cross-validation-example-1" class="slide level2">
<h2>k-fold Cross-validation Example</h2>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="co"># Create predictive model</span></span>
<span id="cb10-2"><a href="#cb10-2"></a>lm_1 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> data)</span>
<span id="cb10-3"><a href="#cb10-3"></a>lm_10 <span class="ot">&lt;-</span> <span class="fu">lm</span>(y <span class="sc">~</span> <span class="fu">poly</span>(x, <span class="dv">10</span>), <span class="at">data =</span> data)</span>
<span id="cb10-4"><a href="#cb10-4"></a></span>
<span id="cb10-5"><a href="#cb10-5"></a><span class="co"># Create smooth lines for plotting</span></span>
<span id="cb10-6"><a href="#cb10-6"></a>x_fit <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">seq</span>(<span class="fu">min</span>(data<span class="sc">$</span>x), <span class="fu">max</span>(data<span class="sc">$</span>x), <span class="at">length =</span> <span class="dv">100</span>))</span>
<span id="cb10-7"><a href="#cb10-7"></a>line_fit_1 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x_fit, <span class="at">y =</span> <span class="fu">predict</span>(lm_1, <span class="at">newdata =</span> x_fit))</span>
<span id="cb10-8"><a href="#cb10-8"></a>line_fit_10 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> x_fit, <span class="at">y =</span> <span class="fu">predict</span>(lm_10, <span class="at">newdata =</span> x_fit))</span>
<span id="cb10-9"><a href="#cb10-9"></a></span>
<span id="cb10-10"><a href="#cb10-10"></a><span class="co"># Recode split for legend</span></span>
<span id="cb10-11"><a href="#cb10-11"></a>data <span class="ot">&lt;-</span> data <span class="sc">%&gt;%</span> </span>
<span id="cb10-12"><a href="#cb10-12"></a>  <span class="fu">mutate</span>(<span class="at">Fold =</span> <span class="fu">fct_recode</span>(<span class="fu">as.factor</span>(split), <span class="st">"Fold 1"</span> <span class="ot">=</span> <span class="st">"1"</span>, <span class="st">"Fold 2"</span> <span class="ot">=</span> <span class="st">"2"</span>,</span>
<span id="cb10-13"><a href="#cb10-13"></a>                           <span class="st">"Fold 3"</span> <span class="ot">=</span> <span class="st">"3"</span>, <span class="st">"Fold 4"</span> <span class="ot">=</span> <span class="st">"4"</span>, <span class="st">"Fold 5"</span> <span class="ot">=</span> <span class="st">"5"</span>))</span>
<span id="cb10-14"><a href="#cb10-14"></a></span>
<span id="cb10-15"><a href="#cb10-15"></a>g_cv <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">color =</span> Fold)) <span class="sc">+</span> <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb10-16"><a href="#cb10-16"></a>  <span class="fu">labs</span>(<span class="at">title =</span> <span class="st">"Cross-validation"</span>) <span class="sc">+</span> my_theme</span>
<span id="cb10-17"><a href="#cb10-17"></a>g_cv1 <span class="ot">&lt;-</span> g_cv <span class="sc">+</span> </span>
<span id="cb10-18"><a href="#cb10-18"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Degree 1 CV error:"</span>, <span class="fu">round</span>(cv_err[<span class="dv">1</span>], <span class="dv">3</span>))) <span class="sc">+</span></span>
<span id="cb10-19"><a href="#cb10-19"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> line_fit_1, <span class="fu">aes</span>(<span class="at">y =</span> y, <span class="at">x =</span> x), <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">lwd =</span> <span class="fl">1.5</span>)</span>
<span id="cb10-20"><a href="#cb10-20"></a>g_cv10 <span class="ot">&lt;-</span> g_cv <span class="sc">+</span> </span>
<span id="cb10-21"><a href="#cb10-21"></a>  <span class="fu">labs</span>(<span class="at">subtitle =</span> <span class="fu">paste</span>(<span class="st">"Degree 10 CV error:"</span>, <span class="fu">round</span>(cv_err[<span class="dv">2</span>], <span class="dv">3</span>))) <span class="sc">+</span></span>
<span id="cb10-22"><a href="#cb10-22"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> line_fit_10, <span class="fu">aes</span>(<span class="at">y =</span> y, <span class="at">x =</span> x), <span class="at">col =</span> <span class="st">"black"</span>, <span class="at">lwd =</span> <span class="fl">1.5</span>)</span>
<span id="cb10-23"><a href="#cb10-23"></a><span class="fu">ggarrange</span>(g_cv1, g_cv10, <span class="at">common.legend =</span> <span class="cn">TRUE</span>, <span class="at">legend =</span> <span class="st">"bottom"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="k-fold-cross-validation-example-2" class="slide level2">
<h2>k-fold Cross-validation Example</h2>

<img data-src="26_prediction_files/figure-revealjs/unnamed-chunk-18-1.png" width="960" class="r-stretch quarto-figure-center"></section>
<section id="statistical-prediction-algorithms" class="slide level2">
<h2>Statistical Prediction Algorithms</h2>
<p>We’ve talked about how regression can be used for both statistical inference and prediction. We are now going to shift to talk about algorithms designed specifically for statistical prediction.</p>
<p>We will discuss only a few methods for this course to teach you about the principles of how they work. This will serve as an introduction to topics you may encounter if you venture further into fields such as <strong>machine learning</strong>.</p>
</section>
<section id="statistical-prediction-algorithms-1" class="slide level2">
<h2>Statistical Prediction Algorithms</h2>
<p>The normal distribution, specified by parameters for the mean and the variance, is an example of a <strong>parametric model</strong>. We are now going to discuss some <strong>non-parametric models</strong>. As the name implies, these models do not assume that the data are drawn from some distribution with a fixed number of parameters.</p>
<p>Non-parametric models are not motivated by inference on model parameters. Instead, the focus is often on pure prediction. How can we use data to help us classify and predict the world around us? For the most part, many of these methods would have been impossible before the rise of high-powered computing.</p>
</section>
<section id="k-nearest-neighbors" class="slide level2">
<h2>k-nearest neighbors</h2>
<p>k-nearest neighbors is a non-parametric prediction algorithm.</p>
<ul>
<li><strong>Input:</strong> training data <span class="math inline">\(X_i = (X_{i1}, \ldots, X_{ip})\)</span> and output class <span class="math inline">\(Y_i\)</span> for <span class="math inline">\(i = 1,\ldots, n\)</span></li>
<li><strong>Input:</strong> test data <span class="math inline">\(X^* = (X^*_1, \ldots, X^*_p)\)</span> with unknown output class <span class="math inline">\(Y^*\)</span></li>
<li><strong>Algorithm:</strong> Find <span class="math inline">\(X_{(1)},\ldots, X_{(k)}\)</span>, the <span class="math inline">\(k\)</span> nearest points to <span class="math inline">\(X^*\)</span></li>
<li><strong>Output:</strong> Predicted class <span class="math inline">\(\hat{Y}^*\)</span>, the most common class from <span class="math inline">\(X_{(1)},\ldots, X_{(k)}\)</span></li>
</ul>
</section>
<section id="k-nearest-neighbors-1" class="slide level2">
<h2>k-nearest neighbors</h2>
<p>This method is simple and highly flexible, but it can also be slow and inappropriate for certain settings.</p>

<img data-src="images/knn.png" class="r-stretch quarto-figure-center"><p>Image Credit: An Introduction to Statistical Learning by Gareth James, Daniela Witten, Trevor Hastie, Robert Tibshirani</p>
</section>
<section id="k-nearest-neighbors-2" class="slide level2">
<h2>k-nearest neighbors</h2>

<img data-src="images/knn2.png" class="r-stretch quarto-figure-center"><p>Image Credit: An Introduction to Statistical Learning by Gareth James, Daniela Witten, Trevor Hastie, Robert Tibshirani</p>
</section>
<section id="choosing-k" class="slide level2">
<h2>Choosing k</h2>
<p>What happens when <span class="math inline">\(k=1\)</span>? <span class="math inline">\(k = n\)</span>?</p>
<p>In order to choose an “optimal” <span class="math inline">\(k\)</span>, it is common to use cross-validation:</p>
<ul>
<li>For <span class="math inline">\(k=1,\ldots,n\)</span> (or a more restrictive range), fit <span class="math inline">\(k\)</span>-nearest neighbors</li>
<li>Use cross-validation to identify <span class="math inline">\(k\)</span> with the minimum test error</li>
<li>Re-train a <span class="math inline">\(k\)</span>-nearest neighbor model using all the data with optimal choice of <span class="math inline">\(k\)</span></li>
</ul>
<p>Cross-validation is a great tool to choose values for tuning parameters across a number of algorithms, not just <span class="math inline">\(k\)</span>-nearest neighbors!</p>
</section>
<section id="choosing-k-1" class="slide level2">
<h2>Choosing k</h2>

<img data-src="images/choosek.png" class="r-stretch quarto-figure-center"></section>
<section id="choosing-k-2" class="slide level2">
<h2>Choosing k</h2>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="images/doubledescent.png"></p>
</figure>
</div>
<div class="quarto-figure quarto-figure-center">
<figure>
<p><img data-src="https://en.wikipedia.org/wiki/Double_descent#/media/File:Double_descent_in_a_two-layer_neural_network_(Figure_3a_from_Rocks_et_al._2022).png"></p>
<figcaption>Image Credit</figcaption>
</figure>
</div>
</section>
<section id="trees" class="slide level2">
<h2>Trees</h2>
<p>Instead of classifying based on neighboring data points in the training data, we can classify based on splits in our covariates.</p>
<ul>
<li><strong>Input:</strong> training data <span class="math inline">\(X_i = (X_{i1}, \ldots, X_{ip})\)</span> and output class/value <span class="math inline">\(Y_i\)</span> for <span class="math inline">\(i = 1,\ldots, n\)</span></li>
<li><strong>Input:</strong> test data <span class="math inline">\(X^* = (X^*_1, \ldots, X^*_p)\)</span> with unknown output class/value <span class="math inline">\(Y^*\)</span></li>
<li><strong>Algorithm:</strong> Identify splits in <span class="math inline">\(X_i\)</span> that best predict <span class="math inline">\(Y_i\)</span></li>
<li><strong>Output:</strong> Predicted class/value <span class="math inline">\(\hat{Y}^*\)</span> using splits</li>
</ul>
</section>
<section id="trees-1" class="slide level2">
<h2>Trees</h2>
<p>Trees to predict class are referred to as <strong>classification trees</strong>. Trees to predict quantitative output are referred to as <strong>regression trees</strong>.</p>
<p>This algorithm is easy, efficient, and interpretable, but it is not as flexible as <span class="math inline">\(k\)</span>-nearest neighbors.</p>

<img data-src="images/tree.png" class="r-stretch quarto-figure-center"><p><a href="http://www.stat.cmu.edu/~ryantibs/statcomp/lectures/prediction.html">Image source</a></p>
</section>
<section id="random-forest" class="slide level2">
<h2>Random Forest</h2>
<p>In practice, we don’t typically predict with a single tree. Instead, we combine multiple trees and take the average/most common of their predictions. Keeping with the tree metaphor, this is referred to as the <strong>random forest</strong> algorithm.</p>
</section>
<section id="random-forest-1" class="slide level2">
<h2>Random Forest</h2>

<img data-src="images/randomforest.png" class="r-stretch quarto-figure-center"><p><a href="https://towardsdatascience.com/random-forests-and-decision-trees-from-scratch-in-python-3e4fa5ae4249">Image source</a></p>
</section>
<section id="random-forest-2" class="slide level2">
<h2>Random Forest</h2>

<img data-src="images/randomforest2.jpeg" class="r-stretch quarto-figure-center"><p><a href="https://towardsdatascience.com/understanding-random-forest-58381e0602d2">Image source</a></p>
</section>
<section id="variable-importance" class="slide level2">
<h2>Variable Importance</h2>
<p>One major benefit of tree-based prediction algorithms is that they provide a powerful and interpretable tool for assessing <strong>variable importance</strong>. For example, we can look across all trees in a random forest, assess how often variables were used for splitting and how helpful those splits were for prediction, and identify the variables that improve our predictions the most!</p>
<p>(For more on this, see the <em>Gini index</em> and “An Introduction to Statistical Learning” by Gareth James, Daniela Witten, Trevor Hastie, Robert Tibshirani.)</p>
</section>
<section id="statistical-prediction-algorithms-2" class="slide level2">
<h2>Statistical Prediction Algorithms</h2>
<p>This was a very brief overfiew of a very small subset of the algorithms used for statistical prediction. Other common examples include:</p>
<ul>
<li>neural networks,</li>
<li>support vector machines,</li>
<li>kernel classifiers,</li>
<li>Bayesian classifiers,</li>
<li>and more…</li>
</ul>
<p>These algorithms, and related topics, are likely things that you will cover if you take courses more focused on machine learning.</p>

<div class="footer footer-default">

</div>
</section></section>
    </div>
  </div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'smaller': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: false,

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: false,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'none',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1050,

        height: 700,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button', {
        text: function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
        }
      });
      clipboard.on('success', function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      });
      function tippyHover(el, contentFn) {
        const config = {
          allowHTML: true,
          content: contentFn,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start'
        };
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          return note.innerHTML;
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>